<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>iNasi - Your Zimbabwean Information Portal</title>
    <link href="https://fonts.googleapis.com/css2?family=DM+Sans:wght@400;500;600;700&family=Playfair+Display:wght@700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.2/css/all.min.css">
    <script src="https://unpkg.com/lucide@latest"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        :root {
            --zim-green: #319F43;
            --zim-yellow: #FFD200;
            --zim-red: #DE2010;
            --zim-black: #0F0F0F;
            --bg-primary: #FAFAFA;
            --bg-secondary: #FFFFFF;
            --text-primary: #1A1A1A;
            --text-secondary: #666666;
            --border-color: #E5E5E5;
            --card-shadow: 0 2px 12px rgba(0,0,0,0.08);
        }

        .dark {
            --bg-primary: #0F0F0F;
            --bg-secondary: #1A1A1A;
            --text-primary: #F5F5F5;
            --text-secondary: #A0A0A0;
            --border-color: #2A2A2A;
            --card-shadow: 0 2px 12px rgba(0,0,0,0.3);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'DM Sans', sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            min-height: 100vh;
            padding-bottom: 80px;
            transition: background 0.3s, color 0.3s;
        }

        /* Header */
        .header {
            background: linear-gradient(135deg, var(--zim-green) 0%, #257a33 100%);
            padding: 16px 20px;
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .header-content {
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .logo {
            font-family: 'Playfair Display', serif;
            font-size: 24px;
            color: white;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .logo-icon {
            width: 32px;
            height: 32px;
            background: var(--zim-yellow);
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 16px;
        }

        .header-date {
            color: rgba(255,255,255,0.85);
            font-size: 12px;
        }

        .header-right {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .theme-toggle {
            background: rgba(255,255,255,0.15);
            border: none;
            width: 36px;
            height: 36px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
            color: white;
            font-size: 16px;
        }

        .theme-toggle:hover {
            background: rgba(255,255,255,0.25);
            transform: scale(1.05);
        }

        .theme-toggle:active {
            transform: scale(0.95);
        }

        .theme-toggle .fa-sun {
            display: none;
        }

        .theme-toggle .fa-moon {
            display: block;
        }

        .dark .theme-toggle .fa-sun {
            display: block;
        }

        .dark .theme-toggle .fa-moon {
            display: none;
        }

        /* Main Content */
        .main-content {
            padding: 16px;
            max-width: 600px;
            margin: 0 auto;
        }

        .page {
            display: none;
            animation: fadeIn 0.3s ease;
        }

        .page.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Section Headers */
        .section-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 16px;
        }

        .section-title {
            font-size: 18px;
            font-weight: 700;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .section-title i {
            color: var(--zim-green);
        }

        .see-all {
            color: var(--zim-green);
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            text-decoration: none;
        }

        /* Cards */
        .card {
            background: var(--bg-secondary);
            border-radius: 16px;
            padding: 16px;
            margin-bottom: 12px;
            box-shadow: var(--card-shadow);
            border: 1px solid var(--border-color);
            transition: transform 0.2s, box-shadow 0.2s;
        }

        .card:active {
            transform: scale(0.98);
        }
        
                /* Exchange Rate Widget */
        .rates-widget {
            background: linear-gradient(135deg, #1a1a1a 0%, #2d2d2d 100%);
            border-radius: 16px;
            padding: 20px;
            margin-bottom: 20px;
            color: white;
        }

        .dark .rates-widget {
            background: linear-gradient(135deg, #252525 0%, #1a1a1a 100%);
            border: 1px solid #333;
        }

        .rates-widget-title {
            font-size: 14px;
            opacity: 0.8;
            margin-bottom: 12px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .rates-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 12px;
        }

        .rate-item {
            text-align: center;
            padding: 12px 8px;
            background: rgba(255,255,255,0.1);
            border-radius: 12px;
        }

        .rate-currency {
            font-size: 12px;
            opacity: 0.7;
            margin-bottom: 4px;
        }

        .rate-value {
            font-size: 18px;
            font-weight: 700;
            color: var(--zim-yellow);
        }

        .rate-label {
            font-size: 10px;
            opacity: 0.6;
            margin-top: 4px;
        }

        /* Detailed Rates Page Styles */
        .rates-page-header {
            text-align: center;
            margin-bottom: 24px;
        }

        .rates-page-title {
            font-size: 22px;
            font-weight: 700;
            margin-bottom: 8px;
        }

        .rates-page-subtitle {
            font-size: 13px;
            color: var(--text-secondary);
        }

        .rates-detailed-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 12px;
            margin-bottom: 24px;
        }

        .rate-detail-card {
            background: var(--bg-secondary);
            border-radius: 12px;
            padding: 16px;
            border: 1px solid var(--border-color);
            text-align: center;
        }

        .rate-detail-card .currency-pair {
            font-size: 12px;
            font-weight: 600;
            color: var(--text-secondary);
            margin-bottom: 8px;
            text-transform: uppercase;
        }

        .rate-detail-card .rate-value {
            font-size: 24px;
            font-weight: 700;
            color: var(--zim-green);
            margin-bottom: 4px;
        }

        .rate-detail-card .rate-change {
            font-size: 11px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 4px;
        }

        .rate-detail-card .rate-change.up {
            color: #22c55e;
        }

        .rate-detail-card .rate-change.down {
            color: #ef4444;
        }

        .rate-detail-card .rate-change.neutral {
            color: var(--text-secondary);
        }

        .chart-container {
            background: var(--bg-secondary);
            border-radius: 16px;
            padding: 20px;
            border: 1px solid var(--border-color);
            margin-bottom: 20px;
        }

        .chart-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 16px;
        }

        .chart-title {
            font-size: 16px;
            font-weight: 600;
        }

        .chart-period-selector {
            display: flex;
            gap: 8px;
        }

        .chart-period-btn {
            padding: 6px 12px;
            border: none;
            background: var(--bg-primary);
            color: var(--text-secondary);
            border-radius: 20px;
            font-size: 12px;
            cursor: pointer;
            transition: all 0.2s;
        }

        .chart-period-btn.active {
            background: var(--zim-green);
            color: white;
        }

        .chart-legend {
            display: flex;
            flex-wrap: wrap;
            gap: 12px;
            margin-top: 16px;
            justify-content: center;
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 6px;
            font-size: 11px;
            color: var(--text-secondary);
        }

        .legend-dot {
            width: 10px;
            height: 10px;
            border-radius: 50%;
        }


        /* News Cards */
        .news-card {
            cursor: pointer;
        }

        .news-card-with-image {
            display: flex;
            gap: 14px;
            cursor: pointer;
        }

        .news-image {
            width: 100px;
            height: 100px;
            border-radius: 12px;
            background: linear-gradient(135deg, var(--zim-green) 0%, #257a33 50%, var(--zim-yellow) 100%);
            flex-shrink: 0;
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
            position: relative;
            background-size: cover;
            background-position: center;
        }

        .news-image.has-image .news-image-icon {
            display: none;
        }

        .news-image-icon {
            font-size: 28px;
            color: rgba(255,255,255,0.9);
        }

        .news-image-category {
            position: absolute;
            bottom: 6px;
            left: 6px;
            background: rgba(0,0,0,0.6);
            color: white;
            font-size: 9px;
            font-weight: 600;
            padding: 3px 6px;
            border-radius: 4px;
            text-transform: uppercase;
        }

        .news-card-content {
            flex: 1;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }

        .news-card-content .news-title {
            font-size: 14px;
            margin-bottom: 6px;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }

        .news-card-content .news-excerpt {
            font-size: 12px;
            color: var(--text-secondary);
            line-height: 1.4;
            margin-bottom: 6px;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }

        .news-card-content .news-meta {
            font-size: 11px;
        }

        .news-category {
            display: inline-block;
            background: rgba(49, 159, 67, 0.1);
            color: var(--zim-green);
            font-size: 11px;
            font-weight: 600;
            padding: 4px 10px;
            border-radius: 20px;
            margin-bottom: 10px;
        }

        .news-title {
            font-size: 16px;
            font-weight: 600;
            line-height: 1.4;
            margin-bottom: 8px;
        }

        .news-excerpt {
            font-size: 14px;
            color: var(--text-secondary);
            line-height: 1.5;
            margin-bottom: 12px;
        }

        .news-meta {
            display: flex;
            align-items: center;
            gap: 12px;
            font-size: 12px;
            color: var(--text-secondary);
        }

        .news-source {
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .source-dot {
            width: 6px;
            height: 6px;
            background: var(--zim-green);
            border-radius: 50%;
        }

        /* Job Cards */
        .job-card {
            display: flex;
            gap: 14px;
        }

        .job-logo {
            width: 50px;
            height: 50px;
            background: linear-gradient(135deg, var(--zim-green), #257a33);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 700;
            font-size: 18px;
            flex-shrink: 0;
        }

        .job-info {
            flex: 1;
        }

        .job-title {
            font-size: 15px;
            font-weight: 600;
            margin-bottom: 4px;
        }

        .job-company {
            font-size: 13px;
            color: var(--text-secondary);
            margin-bottom: 8px;
        }

        .job-tags {
            display: flex;
            flex-wrap: wrap;
            gap: 6px;
        }

        .job-tag {
            background: var(--bg-primary);
            padding: 4px 10px;
            border-radius: 6px;
            font-size: 11px;
            color: var(--text-secondary);
        }

        /* Radio Cards */
        .radio-card {
            display: flex;
            align-items: center;
            gap: 14px;
        }

        .radio-cover {
            width: 60px;
            height: 60px;
            background: linear-gradient(135deg, var(--zim-red), #a5150c);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 24px;
            flex-shrink: 0;
        }

        .radio-info {
            flex: 1;
        }

        .radio-name {
            font-size: 15px;
            font-weight: 600;
            margin-bottom: 4px;
        }

        .radio-freq {
            font-size: 13px;
            color: var(--text-secondary);
        }

        .radio-play-btn {
            width: 44px;
            height: 44px;
            background: var(--zim-green);
            border-radius: 50%;
            border: none;
            color: white;
            font-size: 16px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: transform 0.2s, background 0.2s;
        }

        .radio-play-btn:hover {
            background: #257a33;
            transform: scale(1.05);
        }

        .radio-play-btn.playing {
            background: var(--zim-red);
        }

        /* Horizontal Scroll Radio */
        .radio-scroll-container {
            display: flex;
            gap: 12px;
            overflow-x: auto;
            padding-bottom: 8px;
            margin-bottom: 16px;
            scrollbar-width: none;
            -ms-overflow-style: none;
        }

        .radio-scroll-container::-webkit-scrollbar {
            display: none;
        }

        .radio-scroll-card {
            flex-shrink: 0;
            width: 160px;
            background: var(--bg-secondary);
            border-radius: 14px;
            padding: 14px;
            border: 1px solid var(--border-color);
            box-shadow: var(--card-shadow);
        }

        .radio-scroll-icon {
            width: 44px;
            height: 44px;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 18px;
            margin-bottom: 10px;
        }

        .radio-scroll-name {
            font-size: 13px;
            font-weight: 600;
            margin-bottom: 2px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .radio-scroll-freq {
            font-size: 11px;
            color: var(--text-secondary);
            margin-bottom: 10px;
        }

        .radio-listen-btn {
            width: 100%;
            padding: 8px 12px;
            border-radius: 20px;
            border: none;
            font-size: 12px;
            font-weight: 600;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 6px;
            font-family: inherit;
            transition: all 0.2s;
            background: var(--zim-green);
            color: white;
        }

        .radio-listen-btn:hover {
            background: #257a33;
        }

        .radio-listen-btn.playing {
            background: var(--zim-red);
        }

        /* Bottom Navigation */
        .bottom-nav {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: var(--bg-secondary);
            border-top: 1px solid var(--border-color);
            display: flex;
            justify-content: space-around;
            padding: 8px 0;
            padding-bottom: max(8px, env(safe-area-inset-bottom));
            z-index: 1000;
        }

        .nav-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 4px;
            padding: 8px 16px;
            border: none;
            background: none;
            cursor: pointer;
            color: var(--text-secondary);
            transition: color 0.2s;
            font-family: inherit;
        }

        .nav-item i {
            font-size: 20px;
        }

        .nav-item span {
            font-size: 11px;
            font-weight: 500;
        }

        .nav-item.active {
            color: var(--zim-green);
        }

        .nav-item.active i {
            transform: scale(1.1);
        }

        /* Full Article Modal */
        .modal-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.5);
            z-index: 2000;
            animation: fadeIn 0.2s ease;
        }

        .modal-overlay.active {
            display: block;
        }

        .article-modal {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: var(--bg-primary);
            z-index: 2001;
            overflow-y: auto;
            transform: translateY(100%);
            transition: transform 0.3s ease;
        }

        .article-modal.active {
            transform: translateY(0);
        }

        .modal-header {
            position: sticky;
            top: 0;
            background: var(--bg-secondary);
            padding: 16px 20px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            border-bottom: 1px solid var(--border-color);
            z-index: 10;
        }

        .modal-close {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: var(--bg-primary);
            border: none;
            font-size: 18px;
            cursor: pointer;
            color: var(--text-primary);
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .modal-title {
            font-size: 16px;
            font-weight: 600;
        }

        .article-content {
            padding: 20px;
        }

        .article-category {
            display: none;
        }

        .article-title {
            font-family: 'Playfair Display', serif;
            font-size: 24px;
            line-height: 1.3;
            margin-bottom: 16px;
        }

        .article-meta {
            display: flex;
            align-items: center;
            gap: 16px;
            font-size: 13px;
            color: var(--text-secondary);
            margin-bottom: 24px;
            padding-bottom: 16px;
            border-bottom: 1px solid var(--border-color);
        }

        .article-body {
            font-size: 16px;
            line-height: 1.8;
            color: var(--text-primary);
        }

        .article-body p {
            margin-bottom: 16px;
        }

        /* Share Section */
        .share-section {
            margin-top: 32px;
            padding-top: 24px;
            border-top: 1px solid var(--border-color);
        }

        .share-title {
            font-size: 14px;
            font-weight: 600;
            margin-bottom: 16px;
            color: var(--text-primary);
        }

        .share-buttons {
            display: flex;
            gap: 12px;
        }

        .share-btn {
            width: 48px;
            height: 48px;
            border-radius: 12px;
            border: none;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            color: white;
            cursor: pointer;
            transition: transform 0.2s, opacity 0.2s;
        }

        .share-btn:hover {
            transform: scale(1.1);
        }

        .share-btn:active {
            transform: scale(0.95);
        }

        .share-btn.facebook {
            background: #1877F2;
        }

        .share-btn.twitter {
            background: #000000;
        }

        .share-btn.linkedin {
            background: #0A66C2;
        }

        .share-btn.whatsapp {
            background: #25D366;
        }

        /* Related Articles Section */
        .related-section {
            margin-top: 32px;
            padding-top: 24px;
            border-top: 1px solid var(--border-color);
        }

        .related-title {
            font-size: 16px;
            font-weight: 700;
            margin-bottom: 16px;
            color: var(--text-primary);
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .related-title i {
            color: var(--zim-green);
        }

        .related-articles-list {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .related-article-card {
            display: flex;
            gap: 12px;
            padding: 12px;
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: 12px;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
        }

        .related-article-card:hover {
            transform: translateX(4px);
            box-shadow: var(--card-shadow);
        }

        .related-article-image {
            width: 70px;
            height: 70px;
            border-radius: 10px;
            background-size: cover;
            background-position: center;
            flex-shrink: 0;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .related-article-image i {
            font-size: 20px;
            color: rgba(255,255,255,0.9);
        }

        .related-article-content {
            flex: 1;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }

        .related-article-title {
            font-size: 13px;
            font-weight: 600;
            line-height: 1.3;
            margin-bottom: 4px;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }

        .related-article-meta {
            font-size: 11px;
            color: var(--text-secondary);
        }

        /* AI Rewrite Section */
        .ai-section {
            margin-top: 24px;
            padding-top: 20px;
            border-top: 2px dashed var(--border-color);
        }

        .ai-section-title {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 14px;
            font-weight: 600;
            margin-bottom: 16px;
            color: var(--zim-green);
        }

        .ai-section-title i,
        .ai-section-title svg {
            width: 16px;
            height: 16px;
        }

        .ai-section-card {
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: 12px;
            padding: 16px;
            margin-bottom: 20px;
        }

        .ai-option-desc {
            color: var(--text-secondary);
            font-weight: 400;
            margin-left: 2px;
        }

        .ai-options {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 8px;
            margin-bottom: 16px;
        }

        .ai-option {
            padding: 10px 16px;
            border-radius: 10px;
            border: 2px solid var(--border-color);
            background: var(--bg-secondary);
            font-size: 13px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s;
            color: var(--text-primary);
            font-family: inherit;
        }

        .ai-option:hover {
            border-color: var(--zim-green);
            background: rgba(49, 159, 67, 0.05);
        }

        .ai-option.active {
            background: var(--zim-green);
            border-color: var(--zim-green);
            color: white;
        }

        .ai-output {
            background: var(--bg-secondary);
            border-radius: 12px;
            padding: 16px;
            border: 1px solid var(--border-color);
            min-height: 100px;
            display: none;
        }

        .ai-output.active {
            display: block;
        }

        .ai-output-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 12px;
        }

        .ai-output-label {
            font-size: 12px;
            font-weight: 600;
            color: var(--zim-green);
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .ai-output-label svg {
            width: 14px;
            height: 14px;
        }

        .ai-output-close {
            width: 24px;
            height: 24px;
            border-radius: 50%;
            border: none;
            background: var(--bg-primary);
            color: var(--text-secondary);
            font-size: 12px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s;
        }

        .ai-output-close:hover {
            background: var(--border-color);
            color: var(--text-primary);
        }

        .ai-output-content {
            font-size: 15px;
            line-height: 1.7;
            color: var(--text-primary);
        }

        .ai-loading {
            display: flex;
            align-items: center;
            gap: 10px;
            color: var(--text-secondary);
            font-size: 14px;
        }

        .ai-loading .spinner {
            width: 20px;
            height: 20px;
            border: 2px solid var(--border-color);
            border-top-color: var(--zim-green);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* Radio Player */
        .now-playing {
            display: none;
            position: fixed;
            bottom: 76px;
            left: 12px;
            right: 12px;
            background: linear-gradient(135deg, #1a1a1a, #2d2d2d);
            color: white;
            border-radius: 14px;
            padding: 12px 16px;
            z-index: 999;
            box-shadow: 0 4px 20px rgba(0,0,0,0.3);
            animation: slideUp 0.3s ease;
        }

        .now-playing.active {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        @keyframes slideUp {
            from { transform: translateY(20px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }

        .now-playing-info {
            flex: 1;
        }

        .now-playing-station {
            font-size: 14px;
            font-weight: 600;
        }

        .now-playing-status {
            font-size: 12px;
            opacity: 0.7;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .live-dot {
            width: 6px;
            height: 6px;
            background: var(--zim-red);
            border-radius: 50%;
            animation: pulse 1.5s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        .now-playing-close {
            width: 36px;
            height: 36px;
            background: rgba(255,255,255,0.15);
            border: none;
            border-radius: 50%;
            color: white;
            font-size: 14px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        /* Search Bar */
        .search-bar {
            background: var(--bg-secondary);
            border-radius: 12px;
            padding: 12px 16px;
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 20px;
            border: 1px solid var(--border-color);
        }

        .search-bar i {
            color: var(--text-secondary);
        }

        .search-bar input {
            flex: 1;
            border: none;
            background: none;
            font-size: 16px;
            color: var(--text-primary);
            font-family: inherit;
        }

        .search-bar input::placeholder {
            color: var(--text-secondary);
        }

        .search-bar input:focus {
            outline: none;
        }

        /* Tabs */
        .tabs {
            display: flex;
            gap: 8px;
            margin-bottom: 16px;
            overflow-x: auto;
            padding-bottom: 4px;
        }

        .tab {
            padding: 10px 18px;
            border-radius: 25px;
            border: none;
            background: var(--bg-secondary);
            font-size: 13px;
            font-weight: 500;
            cursor: pointer;
            white-space: nowrap;
            color: var(--text-secondary);
            font-family: inherit;
            border: 1px solid var(--border-color);
            transition: all 0.2s;
        }

        .tab.active {
            background: var(--zim-green);
            color: white;
            border-color: var(--zim-green);
        }

        /* Empty state */
        .empty-state {
            text-align: center;
            padding: 40px 20px;
            color: var(--text-secondary);
        }

        .empty-state i {
            font-size: 48px;
            margin-bottom: 16px;
            opacity: 0.5;
        }

        .empty-state h3 {
            font-size: 16px;
            margin-bottom: 8px;
            color: var(--text-primary);
        }

        /* Custom Alert Modal */
        .custom-alert {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.5);
            z-index: 3000;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }

        .custom-alert.active {
            display: flex;
        }

        .custom-alert-content {
            background: var(--bg-secondary);
            border-radius: 16px;
            padding: 24px;
            max-width: 320px;
            width: 100%;
            text-align: center;
        }

        .custom-alert-icon {
            width: 56px;
            height: 56px;
            border-radius: 50%;
            background: rgba(49, 159, 67, 0.1);
            color: var(--zim-green);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            margin: 0 auto 16px;
        }

        .custom-alert-title {
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 8px;
        }

        .custom-alert-message {
            font-size: 14px;
            color: var(--text-secondary);
            margin-bottom: 20px;
            line-height: 1.5;
        }

        .custom-alert-btn {
            background: var(--zim-green);
            color: white;
            border: none;
            padding: 12px 32px;
            border-radius: 25px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            font-family: inherit;
        }

        /* Featured section */
        .featured-banner {
            background: linear-gradient(135deg, var(--zim-green), #1a6b2a);
            border-radius: 16px;
            padding: 20px;
            margin-bottom: 20px;
            color: white;
            position: relative;
            overflow: hidden;
        }

        .featured-banner::before {
            content: '';
            position: absolute;
            top: -50%;
            right: -30%;
            width: 200px;
            height: 200px;
            background: rgba(255,255,255,0.1);
            border-radius: 50%;
        }

        .featured-label {
            font-size: 11px;
            text-transform: uppercase;
            letter-spacing: 1px;
            opacity: 0.8;
            margin-bottom: 8px;
        }

        .featured-title {
            font-family: 'Playfair Display', serif;
            font-size: 20px;
            line-height: 1.3;
            margin-bottom: 12px;
        }

        .featured-cta {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            font-size: 13px;
            font-weight: 600;
            color: var(--zim-yellow);
        }

        /* Pagination */
        .pagination {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            margin-top: 20px;
            padding: 16px 0;
        }

        .pagination-btn {
            width: 40px;
            height: 40px;
            border-radius: 10px;
            border: 1px solid var(--border-color);
            background: var(--bg-secondary);
            color: var(--text-primary);
            font-size: 14px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s;
            font-family: inherit;
        }

        .pagination-btn:hover:not(:disabled) {
            border-color: var(--zim-green);
            color: var(--zim-green);
        }

        .pagination-btn:disabled {
            opacity: 0.4;
            cursor: not-allowed;
        }

        .pagination-btn.active {
            background: var(--zim-green);
            border-color: var(--zim-green);
            color: white;
        }

        .pagination-info {
            font-size: 13px;
            color: var(--text-secondary);
            padding: 0 12px;
        }

        .pagination-arrow {
            width: 36px;
            height: 36px;
            border-radius: 8px;
            border: 1px solid var(--border-color);
            background: var(--bg-secondary);
            color: var(--text-secondary);
            font-size: 12px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s;
        }

        .pagination-arrow:hover:not(:disabled) {
            border-color: var(--zim-green);
            color: var(--zim-green);
            background: rgba(49, 159, 67, 0.05);
        }

        .pagination-arrow:disabled {
            opacity: 0.4;
            cursor: not-allowed;
        }

        /* Job Detail Modal */
        .job-detail-header {
            display: flex;
            gap: 16px;
            align-items: flex-start;
            margin-bottom: 20px;
        }

        .job-detail-logo {
            width: 64px;
            height: 64px;
            background: linear-gradient(135deg, var(--zim-green), #257a33);
            border-radius: 16px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 700;
            font-size: 24px;
            flex-shrink: 0;
        }

        .job-detail-info {
            flex: 1;
        }

        .job-detail-title {
            font-family: 'Playfair Display', serif;
            font-size: 22px;
            line-height: 1.3;
            margin-bottom: 6px;
        }

        .job-detail-company {
            font-size: 14px;
            color: var(--text-secondary);
        }

        .job-detail-meta {
            display: flex;
            flex-wrap: wrap;
            gap: 12px;
            margin-bottom: 16px;
            padding: 16px;
            background: var(--bg-primary);
            border-radius: 12px;
        }

        .job-meta-item {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 13px;
            color: var(--text-secondary);
        }

        .job-meta-item i {
            color: var(--zim-green);
            width: 16px;
        }

        .job-detail-tags {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-bottom: 20px;
        }

        .job-detail-tag {
            background: rgba(49, 159, 67, 0.1);
            color: var(--zim-green);
            padding: 6px 14px;
            border-radius: 20px;
            font-size: 13px;
            font-weight: 500;
        }

        .job-detail-body {
            font-size: 15px;
            line-height: 1.8;
            color: var(--text-primary);
            margin-bottom: 24px;
        }

        .job-detail-body p {
            margin-bottom: 16px;
        }

        /* Job Action Buttons */
        .job-actions {
            display: flex;
            gap: 12px;
            margin-bottom: 24px;
        }

        .job-apply-btn {
            flex: 1;
            padding: 16px;
            background: linear-gradient(135deg, var(--zim-green), #257a33);
            color: white;
            border: none;
            border-radius: 12px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            font-family: inherit;
            transition: transform 0.2s, box-shadow 0.2s;
        }

        .job-apply-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(49, 159, 67, 0.3);
        }

        .job-apply-btn:active {
            transform: translateY(0);
        }

        .job-save-btn {
            width: 56px;
            height: 56px;
            border-radius: 12px;
            border: 2px solid var(--border-color);
            background: var(--bg-secondary);
            color: var(--text-secondary);
            font-size: 20px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s;
            flex-shrink: 0;
        }

        .job-save-btn:hover {
            border-color: var(--zim-yellow);
            color: #d4a600;
        }

        .job-save-btn.saved {
            background: linear-gradient(135deg, var(--zim-yellow), #d4a600);
            border-color: var(--zim-yellow);
            color: #1a1a1a;
        }

        .job-share-btn {
            width: 56px;
            height: 56px;
            border-radius: 12px;
            border: 2px solid var(--border-color);
            background: var(--bg-secondary);
            color: var(--text-secondary);
            font-size: 20px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s;
            flex-shrink: 0;
        }

        .job-share-btn:hover {
            border-color: var(--zim-green);
            color: var(--zim-green);
        }

        /* AI Job Tools Section */
        .ai-job-tools {
            margin-top: 32px;
            padding-top: 24px;
            border-top: 2px dashed var(--border-color);
        }

        .ai-job-tools-header {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 16px;
        }

        .ai-job-tools-icon {
            width: 40px;
            height: 40px;
            border-radius: 10px;
            background: linear-gradient(135deg, #8B5CF6, #6D28D9);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
        }

        .ai-job-tools-title {
            font-size: 16px;
            font-weight: 700;
            color: var(--text-primary);
        }

        .ai-job-tools-subtitle {
            font-size: 12px;
            color: var(--text-secondary);
        }

        .ai-job-tools-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 12px;
        }

        .ai-job-tool-card {
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: 14px;
            padding: 16px;
            cursor: pointer;
            transition: all 0.2s;
            text-align: center;
        }

        .ai-job-tool-card:hover {
            border-color: var(--zim-green);
            transform: translateY(-2px);
            box-shadow: var(--card-shadow);
        }

        .ai-job-tool-icon {
            width: 48px;
            height: 48px;
            border-radius: 12px;
            margin: 0 auto 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            color: white;
        }

        .ai-job-tool-icon.cv {
            background: linear-gradient(135deg, #3B82F6, #1d4ed8);
        }

        .ai-job-tool-icon.cover {
            background: linear-gradient(135deg, #10B981, #059669);
        }

        .ai-job-tool-icon.interview {
            background: linear-gradient(135deg, #F59E0B, #d97706);
        }

        .ai-job-tool-icon.salary {
            background: linear-gradient(135deg, #EC4899, #be185d);
        }

        .ai-job-tool-name {
            font-size: 13px;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 4px;
        }

        .ai-job-tool-desc {
            font-size: 11px;
            color: var(--text-secondary);
            line-height: 1.3;
        }

        /* Job Share Modal */
        .job-share-modal {
            display: none;
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: var(--bg-secondary);
            border-radius: 20px 20px 0 0;
            padding: 24px;
            z-index: 3000;
            transform: translateY(100%);
            transition: transform 0.3s ease;
        }

        .job-share-modal.active {
            display: block;
            transform: translateY(0);
        }

        .job-share-modal-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 20px;
        }

        .job-share-modal-title {
            font-size: 18px;
            font-weight: 700;
        }

        .job-share-modal-close {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            border: none;
            background: var(--bg-primary);
            color: var(--text-secondary);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .job-share-options {
            display: flex;
            justify-content: space-around;
        }

        .job-share-option {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 8px;
            cursor: pointer;
        }

        .job-share-option-icon {
            width: 56px;
            height: 56px;
            border-radius: 16px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            color: white;
            transition: transform 0.2s;
        }

        .job-share-option:hover .job-share-option-icon {
            transform: scale(1.1);
        }

        .job-share-option-label {
            font-size: 12px;
            color: var(--text-secondary);
        }

        /* FAB Styles */
        .fab-container {
            position: fixed;
            bottom: 100px;
            right: 20px;
            z-index: 500;
            display: none;
        }

        .fab-container.active {
            display: block;
        }

        .fab-options {
            display: flex;
            flex-direction: column;
            gap: 12px;
            margin-bottom: 12px;
            opacity: 0;
            transform: translateY(20px);
            pointer-events: none;
            transition: all 0.3s ease;
        }

        .fab-options.active {
            opacity: 1;
            transform: translateY(0);
            pointer-events: auto;
        }

        .fab-option {
            display: flex;
            align-items: center;
            gap: 10px;
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: 25px;
            padding: 12px 18px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.15);
            cursor: pointer;
            transition: all 0.2s;
            white-space: nowrap;
            margin-left: auto;
        }

        .fab-option:hover {
            transform: translateX(-5px);
            box-shadow: 0 6px 20px rgba(0,0,0,0.2);
        }

        .fab-option-icon {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 14px;
        }

        .fab-option-icon.cv {
            background: linear-gradient(135deg, #3B82F6, #1d4ed8);
        }

        .fab-option-icon.cover {
            background: linear-gradient(135deg, #10B981, #059669);
        }

        .fab-option-icon.interview {
            background: linear-gradient(135deg, #F59E0B, #d97706);
        }

        .fab-option-text {
            font-size: 14px;
            font-weight: 600;
            color: var(--text-primary);
        }

        .fab-option-desc {
            font-size: 11px;
            color: var(--text-secondary);
        }

        .fab-main {
            width: 56px;
            height: 56px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--zim-green), #257a33);
            border: none;
            color: white;
            font-size: 24px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 4px 15px rgba(49, 159, 67, 0.4);
            transition: all 0.3s ease;
            margin-left: auto;
        }

        .fab-main:hover {
            transform: scale(1.05);
            box-shadow: 0 6px 20px rgba(49, 159, 67, 0.5);
        }

        .fab-main.active {
            transform: rotate(45deg);
            background: linear-gradient(135deg, var(--zim-red), #a5150c);
        }

        .fab-main svg {
            width: 24px;
            height: 24px;
            transition: transform 0.3s ease;
        }

        /* AI Tool Modal */
        .ai-tool-modal {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: var(--bg-primary);
            z-index: 2001;
            overflow-y: auto;
            transform: translateY(100%);
            transition: transform 0.3s ease;
        }

        .ai-tool-modal.active {
            transform: translateY(0);
        }

        .ai-tool-content {
            padding: 20px;
            max-width: 600px;
            margin: 0 auto;
        }

        .ai-tool-title {
            font-family: 'Playfair Display', serif;
            font-size: 24px;
            margin-bottom: 8px;
        }

        .ai-tool-subtitle {
            color: var(--text-secondary);
            font-size: 14px;
            margin-bottom: 24px;
        }

        .ai-tool-form {
            display: flex;
            flex-direction: column;
            gap: 16px;
        }

        .form-group {
            display: flex;
            flex-direction: column;
            gap: 6px;
        }

        .form-label {
            font-size: 14px;
            font-weight: 600;
            color: var(--text-primary);
        }

        .form-input {
            padding: 14px 16px;
            border: 1px solid var(--border-color);
            border-radius: 12px;
            font-size: 16px;
            font-family: inherit;
            background: var(--bg-secondary);
            color: var(--text-primary);
            transition: border-color 0.2s;
        }

        .form-input:focus {
            outline: none;
            border-color: var(--zim-green);
        }

        .form-textarea {
            min-height: 120px;
            resize: vertical;
        }

        .form-hint {
            font-size: 12px;
            color: var(--text-secondary);
        }

        .ai-generate-btn {
            padding: 16px;
            background: linear-gradient(135deg, var(--zim-green), #257a33);
            color: white;
            border: none;
            border-radius: 12px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            font-family: inherit;
            margin-top: 8px;
        }

        .ai-generate-btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }

        .ai-result-box {
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: 12px;
            padding: 20px;
            margin-top: 20px;
            display: none;
        }

        .ai-result-box.active {
            display: block;
        }

        .ai-result-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 16px;
        }

        .ai-result-title {
            font-size: 14px;
            font-weight: 600;
            color: var(--zim-green);
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .ai-result-title svg {
            width: 16px;
            height: 16px;
        }

        .ai-result-content {
            font-size: 14px;
            line-height: 1.7;
            color: var(--text-primary);
        }

        .ai-result-content p {
            margin-bottom: 12px;
        }

        .ai-result-content .ai-heading {
            font-weight: 700;
            color: var(--text-primary);
            margin-top: 16px;
            margin-bottom: 8px;
        }

        .ai-result-content h2.ai-heading {
            font-size: 18px;
            border-bottom: 2px solid var(--zim-green);
            padding-bottom: 6px;
        }

        .ai-result-content h3.ai-heading {
            font-size: 16px;
            color: var(--zim-green);
        }

        .ai-result-content h4.ai-heading {
            font-size: 14px;
        }

        .ai-result-content strong {
            font-weight: 600;
            color: var(--text-primary);
        }

        .ai-result-content em {
            font-style: italic;
        }

        .ai-result-content .ai-list {
            margin: 12px 0;
            padding-left: 20px;
        }

        .ai-result-content .ai-list li {
            margin-bottom: 6px;
            position: relative;
        }

        .ai-result-content ul.ai-list {
            list-style: none;
            padding-left: 16px;
        }

        .ai-result-content ul.ai-list li::before {
            content: '';
            color: var(--zim-green);
            font-weight: bold;
            position: absolute;
            left: -16px;
        }

        .copy-btn {
            padding: 8px 16px;
            background: var(--bg-primary);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            font-size: 13px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 6px;
            color: var(--text-secondary);
            font-family: inherit;
            transition: all 0.2s;
        }

        .copy-btn:hover {
            border-color: var(--zim-green);
            color: var(--zim-green);
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="header-content">
            <div class="logo">
                <div class="logo-icon"></div>
                iNasi
            </div>
            <div class="header-right">
                <div class="header-date" id="headerDate"></div>
                <button class="theme-toggle" id="themeToggle" aria-label="Toggle theme">
                    <i class="fas fa-moon"></i>
                    <i class="fas fa-sun"></i>
                </button>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="main-content">
        <!-- Home Page -->
        <div class="page active" id="page-home">
            <!-- Exchange Rates Widget -->
            <div class="rates-widget" onclick="openRatesPage()" style="cursor: pointer;">
                <div class="rates-widget-title">
                    <i class="fas fa-chart-line"></i> Today's Exchange Rates
                    <span style="margin-left: auto; font-size: 12px;"><i class="fas fa-chevron-right"></i></span>
                </div>
                <div class="rates-grid">
                    <div class="rate-item">
                        <div class="rate-currency">USD/ZWG</div>
                        <div class="rate-value" id="home-usd">27.5</div>
                        <div class="rate-label">1 USD</div>
                    </div>
                    <div class="rate-item">
                        <div class="rate-currency">ZAR/USD</div>
                        <div class="rate-value" id="home-zar-usd">18.2</div>
                        <div class="rate-label">1 USD</div>
                    </div>
                    <div class="rate-item">
                        <div class="rate-currency">BWP/USD</div>
                        <div class="rate-value" id="home-bwp-usd">13.6</div>
                        <div class="rate-label">1 USD</div>
                    </div>
                </div>
            </div>

            <!-- Featured News -->
            <div class="featured-banner" onclick="openArticle(0)">
                <div class="featured-label">Breaking News</div>
                <div class="featured-title" id="featured-title">Loading news...</div>
                <div class="featured-cta">
                    Read Full Story <i class="fas fa-arrow-right"></i>
                </div>
            </div>

            <!-- Featured Radio - Horizontal Scroll -->
            <div class="section-header">
                <h2 class="section-title"><i class="fas fa-broadcast-tower"></i> Live Radio</h2>
                <a class="see-all" onclick="showPage('radio')">See All</a>
            </div>
            <div class="radio-scroll-container" id="home-radio-list"></div>

            <!-- Latest News -->
            <div class="section-header" style="margin-top: 20px;">
                <h2 class="section-title"><i class="fas fa-fire"></i> Trending News</h2>
                <a class="see-all" onclick="showPage('news')">See All</a>
            </div>
            <div id="home-news-list"></div>

            <!-- Latest Jobs -->
            <div class="section-header" style="margin-top: 24px;">
                <h2 class="section-title"><i class="fas fa-briefcase"></i> Latest Jobs</h2>
                <a class="see-all" onclick="showPage('jobs')">See All</a>
            </div>
            <div id="home-jobs-list"></div>
        </div>

        <!-- News Page -->
        <div class="page" id="page-news">
            <div class="search-bar">
                <i class="fas fa-search"></i>
                <input type="text" placeholder="Search news..." id="news-search" oninput="filterNews()">
            </div>
            <div class="tabs" id="news-tabs">
                <button class="tab active" data-category="all">All</button>
                <button class="tab" data-category="politics">Politics</button>
                <button class="tab" data-category="business">Business</button>
                <button class="tab" data-category="sports">Sports</button>
                <button class="tab" data-category="entertainment">Entertainment</button>
            </div>
            <div id="news-list"></div>
            <div id="news-pagination" class="pagination"></div>
        </div>

        <!-- Jobs Page -->
        <div class="page" id="page-jobs">
            <div class="search-bar">
                <i class="fas fa-search"></i>
                <input type="text" placeholder="Search jobs..." id="job-search" oninput="filterJobs()">
            </div>
            <div class="tabs" id="job-tabs">
                <button class="tab active" data-type="all">All</button>
                <button class="tab" data-type="fulltime">Full-time</button>
                <button class="tab" data-type="parttime">Part-time</button>
                <button class="tab" data-type="remote">Remote</button>
            </div>
            <div id="jobs-list"></div>
            <div id="jobs-pagination" class="pagination"></div>
        </div>

        <!-- Radio Page -->
        <div class="page" id="page-radio">
            <div class="section-header">
                <h2 class="section-title"><i class="fas fa-radio"></i> Radio Stations</h2>
            </div>
            <p style="color: var(--text-secondary); font-size: 13px; margin-bottom: 16px;">
                Listen to your favorite Zimbabwean stations
            </p>
            <div class="tabs" id="radio-tabs">
                <button class="tab active" data-category="all">All</button>
                <button class="tab" data-category="national"> National</button>
                <button class="tab" data-category="commercial"> Commercial</button>
                <button class="tab" data-category="community"> Community</button>
            </div>
            <div id="radio-list"></div>
        </div>
        
        <!-- Rates Modal -->
        <div class="modal-overlay" id="rates-modal-overlay" onclick="closeRatesPage()"></div>
        <div class="article-modal" id="rates-modal">
            <div class="modal-header">
                <button class="modal-close" onclick="closeRatesPage()">
                    <i class="fas fa-arrow-left"></i>
                </button>
                <span class="modal-title">Exchange Rates</span>
                <div style="width: 40px;"></div>
            </div>
            <div class="article-content">
                <div class="rates-page-header">
                    <h1 class="rates-page-title"><i class="fas fa-chart-line" style="color: var(--zim-green);"></i> Exchange Rates</h1>
                    <p class="rates-page-subtitle">Currency rates against USD  Updated today</p>
                </div>

                <!-- Rates Grid -->
                <div class="rates-detailed-grid">
                    <div class="rate-detail-card">
                        <div class="currency-pair">USD / ZWG</div>
                        <div class="rate-value" id="detail-usd-zwg">27.50</div>
                        <div class="rate-change up" id="change-usd-zwg">
                            <i class="fas fa-arrow-up"></i> +0.12%
                        </div>
                    </div>
                    <div class="rate-detail-card">
                        <div class="currency-pair">ZAR / USD</div>
                        <div class="rate-value" id="detail-zar-usd">18.20</div>
                        <div class="rate-change down" id="change-zar-usd">
                            <i class="fas fa-arrow-down"></i> -0.25%
                        </div>
                    </div>
                    <div class="rate-detail-card">
                        <div class="currency-pair">BWP / USD</div>
                        <div class="rate-value" id="detail-bwp-usd">13.60</div>
                        <div class="rate-change up" id="change-bwp-usd">
                            <i class="fas fa-arrow-up"></i> +0.08%
                        </div>
                    </div>
                    <div class="rate-detail-card">
                        <div class="currency-pair">ZAR / BWP</div>
                        <div class="rate-value" id="detail-zar-bwp">1.34</div>
                        <div class="rate-change up" id="change-zar-bwp">
                            <i class="fas fa-arrow-up"></i> +0.10%
                        </div>
                    </div>
                </div>

                <!-- Rate Chart -->
                <div class="chart-container">
                    <div class="chart-header">
                        <h3 class="chart-title">Rate Trends (vs USD)</h3>
                        <div class="chart-period-selector">
                            <button class="chart-period-btn active" onclick="updateChartPeriod('7d')">7D</button>
                            <button class="chart-period-btn" onclick="updateChartPeriod('30d')">30D</button>
                        </div>
                    </div>
                    <div style="height: 200px; position: relative;">
                        <canvas id="ratesChart"></canvas>
                    </div>
                    <div class="chart-legend">
                        <div class="legend-item">
                            <div class="legend-dot" style="background: #319F43;"></div>
                            <span>ZWG</span>
                        </div>
                        <div class="legend-item">
                            <div class="legend-dot" style="background: #FFD200;"></div>
                            <span>ZAR</span>
                        </div>
                        <div class="legend-item">
                            <div class="legend-dot" style="background: #DE2010;"></div>
                            <span>BWP</span>
                        </div>
                    </div>
                </div>

                <!-- AI Analysis Section -->
                <div class="ai-section-card" style="margin-top: 20px;">
                    <div class="ai-section-title" style="margin-bottom: 12px;">
                        <i data-lucide="sparkles"></i>
                        AI Market Analysis
                    </div>
                    <div class="ai-options">
                        <button class="ai-option" onclick="analyzeRates('overview')">
                            <i class="fas fa-chart-pie"></i> Market Overview
                        </button>
                        <button class="ai-option" onclick="analyzeRates('zwg')">
                            <i class="fas fa-dollar-sign"></i> ZWG Analysis
                        </button>
                    </div>
                    <div class="ai-output" id="rates-ai-output">
                        <div class="ai-output-header">
                            <span class="ai-output-label">
                                <i data-lucide="sparkles"></i>
                                <span>AI Analysis</span>
                            </span>
                            <button class="ai-output-close" onclick="closeRatesAiOutput()">
                                <i class="fas fa-times"></i>
                            </button>
                        </div>
                        <div class="ai-output-content" id="rates-ai-content"></div>
                    </div>
                </div>

                <!-- Last Updated Info -->
                <div style="text-align: center; padding: 16px; color: var(--text-secondary); font-size: 12px;">
                    <i class="fas fa-info-circle"></i> Rates are for informational purposes only and may vary from actual market rates.
                </div>
            </div>
        </div>
   
        <!-- Profile Page -->
        <div class="page" id="page-profile">
            <!-- User Info Section -->
            <div class="card" style="text-align: center; padding: 24px;">
                <div style="width: 80px; height: 80px; border-radius: 50%; background: linear-gradient(135deg, var(--zim-green), #257a33); margin: 0 auto 16px; display: flex; align-items: center; justify-content: center; font-size: 32px; color: white;">
                    <i class="fas fa-user"></i>
                </div>
                <h3 id="profile-name" style="margin-bottom: 8px;">Guest User</h3>
                <p id="profile-email" style="color: var(--text-secondary); font-size: 14px; margin-bottom: 20px;">Not signed in</p>
                <button class="ai-generate-btn" onclick="toggleAuth()" id="auth-btn" style="max-width: 200px; margin: 0 auto;">
                    <i class="fas fa-sign-in-alt"></i>
                    Sign In / Sign Up
                </button>
            </div>

            <!-- Settings Section -->
            <div class="card">
                <div class="section-title" style="margin-bottom: 16px;">
                    <i class="fas fa-cog"></i>
                    Settings
                </div>
                
                <!-- Theme Toggle -->
                <div class="setting-item" onclick="toggleTheme()" style="display: flex; justify-content: space-between; align-items: center; padding: 12px 0; cursor: pointer; border-bottom: 1px solid var(--border-color);">
                    <div style="display: flex; align-items: center; gap: 12px;">
                        <div style="width: 36px; height: 36px; border-radius: 10px; background: linear-gradient(135deg, #F59E0B, #d97706); display: flex; align-items: center; justify-content: center; color: white;">
                            <i class="fas fa-moon"></i>
                        </div>
                        <div>
                            <div style="font-weight: 600;">Dark Mode</div>
                            <div style="font-size: 12px; color: var(--text-secondary);">Toggle theme</div>
                        </div>
                    </div>
                    <div class="theme-switch">
                        <div style="width: 44px; height: 24px; background: var(--border-color); border-radius: 12px; position: relative;">
                            <div style="width: 20px; height: 20px; background: var(--zim-green); border-radius: 50%; position: absolute; top: 2px; left: 2px; transition: transform 0.3s;" id="theme-switch-circle"></div>
                        </div>
                    </div>
                </div>

                <!-- Edit Profile -->
                <div class="setting-item" onclick="openEditProfile()" style="display: flex; justify-content: space-between; align-items: center; padding: 12px 0; cursor: pointer; border-bottom: 1px solid var(--border-color);">
                    <div style="display: flex; align-items: center; gap: 12px;">
                        <div style="width: 36px; height: 36px; border-radius: 10px; background: linear-gradient(135deg, #3B82F6, #1d4ed8); display: flex; align-items: center; justify-content: center; color: white;">
                            <i class="fas fa-user-edit"></i>
                        </div>
                        <div>
                            <div style="font-weight: 600;">Edit Profile</div>
                            <div style="font-size: 12px; color: var(--text-secondary);">Update your information</div>
                        </div>
                    </div>
                    <i class="fas fa-chevron-right" style="color: var(--text-secondary);"></i>
                </div>

                <!-- Saved Items -->
                <div class="setting-item" onclick="viewSavedItems()" style="display: flex; justify-content: space-between; align-items: center; padding: 12px 0; cursor: pointer; border-bottom: 1px solid var(--border-color);">
                    <div style="display: flex; align-items: center; gap: 12px;">
                        <div style="width: 36px; height: 36px; border-radius: 10px; background: linear-gradient(135deg, #10B981, #059669); display: flex; align-items: center; justify-content: center; color: white;">
                            <i class="fas fa-bookmark"></i>
                        </div>
                        <div>
                            <div style="font-weight: 600;">Saved Items</div>
                            <div style="font-size: 12px; color: var(--text-secondary);">Jobs and articles</div>
                        </div>
                    </div>
                    <i class="fas fa-chevron-right" style="color: var(--text-secondary);"></i>
                </div>
            </div>

            <!-- Support Section -->
            <div class="card">
                <div class="section-title" style="margin-bottom: 16px;">
                    <i class="fas fa-headset"></i>
                    Support
                </div>
                
                <!-- Contact Us -->
                <div class="setting-item" onclick="contactUs()" style="display: flex; align-items: center; gap: 12px; padding: 12px 0; cursor: pointer; border-bottom: 1px solid var(--border-color);">
                    <div style="width: 36px; height: 36px; border-radius: 10px; background: linear-gradient(135deg, #8B5CF6, #6D28D9); display: flex; align-items: center; justify-content: center; color: white;">
                        <i class="fas fa-envelope"></i>
                    </div>
                    <div>
                        <div style="font-weight: 600;">Contact Us</div>
                        <div style="font-size: 12px; color: var(--text-secondary);">Get in touch</div>
                    </div>
                </div>

                <!-- Privacy Policy -->
                <div class="setting-item" onclick="openPrivacyPolicy()" style="display: flex; align-items: center; gap: 12px; padding: 12px 0; cursor: pointer; border-bottom: 1px solid var(--border-color);">
                    <div style="width: 36px; height: 36px; border-radius: 10px; background: linear-gradient(135deg, #EC4899, #be185d); display: flex; align-items: center; justify-content: center; color: white;">
                        <i class="fas fa-shield-alt"></i>
                    </div>
                    <div>
                        <div style="font-weight: 600;">Privacy Policy</div>
                        <div style="font-size: 12px; color: var(--text-secondary);">How we protect your data</div>
                    </div>
                </div>

                <!-- Terms & Conditions -->
                <div class="setting-item" onclick="openTerms()" style="display: flex; align-items: center; gap: 12px; padding: 12px 0; cursor: pointer;">
                    <div style="width: 36px; height: 36px; border-radius: 10px; background: linear-gradient(135deg, #F59E0B, #d97706); display: flex; align-items: center; justify-content: center; color: white;">
                        <i class="fas fa-file-contract"></i>
                    </div>
                    <div>
                        <div style="font-weight: 600;">Terms & Conditions</div>
                        <div style="font-size: 12px; color: var(--text-secondary);">User agreement</div>
                    </div>
                </div>
            </div>

            <!-- App Info -->
            <div class="card" style="text-align: center; font-size: 12px; color: var(--text-secondary);">
                <p>iNasi v1.0.0</p>
                <p> 2024 Zimbabwean Portal</p>
                <p>Made with  for Zimbabwe</p>
            </div>
        </div>
    </main>

    <!-- Now Playing Bar -->
    <div class="now-playing" id="now-playing">
        <i class="fas fa-music" style="font-size: 20px;"></i>
        <div class="now-playing-info">
            <div class="now-playing-station" id="now-playing-name">Station Name</div>
            <div class="now-playing-status">
                <span class="live-dot"></span> Live
            </div>
        </div>
        <button class="now-playing-close" onclick="stopRadio()">
            <i class="fas fa-stop"></i>
        </button>
    </div>

    <!-- Bottom Navigation -->
    <nav class="bottom-nav">
        <button class="nav-item active" data-page="home" onclick="showPage('home')">
            <i class="fas fa-home"></i>
            <span>Home</span>
        </button>
        <button class="nav-item" data-page="news" onclick="showPage('news')">
            <i class="fas fa-newspaper"></i>
            <span>News</span>
        </button>
        <button class="nav-item" data-page="jobs" onclick="showPage('jobs')">
            <i class="fas fa-briefcase"></i>
            <span>Jobs</span>
        </button>
        <button class="nav-item" data-page="radio" onclick="showPage('radio')">
            <i class="fas fa-broadcast-tower"></i>
            <span>Radio</span>
        </button>
        <button class="nav-item" data-page="profile" onclick="showPage('profile')">
            <i class="fas fa-user"></i>
            <span>Profile</span>
        </button>    
    </nav>

    <!-- Article Modal -->
    <div class="modal-overlay" id="modal-overlay" onclick="closeArticle()"></div>
    <div class="article-modal" id="article-modal">
        <div class="modal-header">
            <button class="modal-close" onclick="closeArticle()">
                <i class="fas fa-arrow-left"></i>
            </button>
            <span class="modal-title">Full Article</span>
            <div style="width: 40px;"></div>
        </div>
        <div class="article-content">
            <span class="article-category" id="article-category">Category</span>
            <h1 class="article-title" id="article-title">Article Title</h1>
            <div class="article-meta">
                <span><i class="fas fa-newspaper" style="margin-right: 4px;"></i> <span id="article-source">Source</span></span>
                <span><i class="fas fa-clock" style="margin-right: 4px;"></i> <span id="article-time">Time</span></span>
            </div>

            <!-- AI Rewrite Section -->
            <div class="ai-section-card">
                <div class="ai-section-title" style="margin-bottom: 12px;">
                    <i data-lucide="sparkles"></i>
                    AI Rewrite / Translate:
                </div>
                <div class="ai-options">
                    <button class="ai-option" onclick="rewriteArticle('concise')">
                        Concise <span class="ai-option-desc">(Key points)</span>
                    </button>
                    <button class="ai-option" onclick="rewriteArticle('simple')">
                        Simple <span class="ai-option-desc">(Easy read)</span>
                    </button>
                    <button class="ai-option" onclick="rewriteArticle('shona')">
                        Shona <span class="ai-option-desc">(Translate)</span>
                    </button>
                    <button class="ai-option" onclick="rewriteArticle('ndebele')">
                        Ndebele <span class="ai-option-desc">(Translate)</span>
                    </button>
                </div>
                <div class="ai-output" id="ai-output">
                    <div class="ai-output-header">
                        <span class="ai-output-label">
                            <i data-lucide="sparkles"></i>
                            <span id="ai-output-mode">AI Rewrite</span>
                        </span>
                        <button class="ai-output-close" onclick="closeAiOutput()">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                    <div class="ai-output-content" id="ai-output-content"></div>
                </div>
            </div>

            <div class="article-body" id="article-body">
                Article content goes here...
            </div>

            <!-- Share Section -->
            <div class="share-section">
                <h3 class="share-title">Share this article</h3>
                <div class="share-buttons">
                    <button class="share-btn facebook" onclick="shareArticle('facebook')" title="Share on Facebook">
                        <i class="fab fa-facebook-f"></i>
                    </button>
                    <button class="share-btn twitter" onclick="shareArticle('twitter')" title="Share on X (Twitter)">
                        <i class="fab fa-x-twitter"></i>
                    </button>
                    <button class="share-btn linkedin" onclick="shareArticle('linkedin')" title="Share on LinkedIn">
                        <i class="fab fa-linkedin-in"></i>
                    </button>
                    <button class="share-btn whatsapp" onclick="shareArticle('whatsapp')" title="Share on WhatsApp">
                        <i class="fab fa-whatsapp"></i>
                    </button>
                </div>
            </div>

            <!-- Related Articles Section -->
            <div class="related-section">
                <h3 class="related-title"><i class="fas fa-newspaper"></i> Related Articles</h3>
                <div class="related-articles-list" id="related-articles-list">
                    <!-- Populated by JS -->
                </div>
            </div>
        </div>
    </div>

    <!-- Job Detail Modal -->
    <div class="modal-overlay" id="job-modal-overlay" onclick="closeJob()"></div>
    <div class="article-modal" id="job-modal">
        <div class="modal-header">
            <button class="modal-close" onclick="closeJob()">
                <i class="fas fa-arrow-left"></i>
            </button>
            <span class="modal-title">Job Details</span>
            <div style="width: 40px;"></div>
        </div>
        <div class="article-content">
            <div class="job-detail-header">
                <div class="job-detail-logo" id="job-detail-logo">E</div>
                <div class="job-detail-info">
                    <h1 class="job-detail-title" id="job-detail-title">Job Title</h1>
                    <p class="job-detail-company" id="job-detail-company">Company  Location</p>
                </div>
            </div>

            <div class="job-detail-meta">
                <div class="job-meta-item">
                    <i class="fas fa-briefcase"></i>
                    <span id="job-detail-type">Full-time</span>
                </div>
                <div class="job-meta-item">
                    <i class="fas fa-money-bill-wave"></i>
                    <span id="job-detail-salary">$1,000/month</span>
                </div>
                <div class="job-meta-item">
                    <i class="fas fa-calendar-alt"></i>
                    <span id="job-detail-posted">Posted 2 days ago</span>
                </div>
            </div>

            <div class="job-detail-tags" id="job-detail-tags"></div>

            <div class="job-detail-body" id="job-detail-body">
                Job description goes here...
            </div>

            <!-- Job Action Buttons -->
            <div class="job-actions">
                <button class="job-apply-btn" onclick="applyForJob()">
                    <i class="fas fa-paper-plane"></i> Apply Now
                </button>
                <button class="job-save-btn" id="job-save-btn" onclick="toggleSaveJob()" title="Save Job">
                    <i class="fas fa-bookmark"></i>
                </button>
                <button class="job-share-btn" onclick="openJobShareModal()" title="Share Job">
                    <i class="fas fa-share-alt"></i>
                </button>
            </div>

            <!-- AI Job Tools Section -->
            <div class="ai-job-tools">
                <div class="ai-job-tools-header">
                    <div class="ai-job-tools-icon">
                        <i data-lucide="sparkles"></i>
                    </div>
                    <div>
                        <h3 class="ai-job-tools-title">AI-Powered Job Tools</h3>
                        <p class="ai-job-tools-subtitle">Let AI help you land this job</p>
                    </div>
                </div>
                <div class="ai-job-tools-grid">
                    <div class="ai-job-tool-card" onclick="generateJobCV()">
                        <div class="ai-job-tool-icon cv">
                            <i class="fas fa-file-alt"></i>
                        </div>
                        <h4 class="ai-job-tool-name">Tailored CV</h4>
                        <p class="ai-job-tool-desc">Generate a CV optimized for this role</p>
                    </div>
                    <div class="ai-job-tool-card" onclick="generateCoverLetter()">
                        <div class="ai-job-tool-icon cover">
                            <i class="fas fa-envelope-open-text"></i>
                        </div>
                        <h4 class="ai-job-tool-name">Cover Letter</h4>
                        <p class="ai-job-tool-desc">Write a compelling cover letter</p>
                    </div>
                    <div class="ai-job-tool-card" onclick="prepareJobInterview()">
                        <div class="ai-job-tool-icon interview">
                            <i class="fas fa-comments"></i>
                        </div>
                        <h4 class="ai-job-tool-name">Interview Prep</h4>
                        <p class="ai-job-tool-desc">Practice questions for this job</p>
                    </div>
                    <div class="ai-job-tool-card" onclick="negotiateSalary()">
                        <div class="ai-job-tool-icon salary">
                            <i class="fas fa-hand-holding-usd"></i>
                        </div>
                        <h4 class="ai-job-tool-name">Salary Tips</h4>
                        <p class="ai-job-tool-desc">Negotiation strategies & insights</p>
                    </div>
                </div>

                <!-- AI Tool Output -->
                <div class="ai-result-box" id="job-ai-result" style="margin-top: 16px;">
                    <div class="ai-result-header">
                        <span class="ai-result-title">
                            <i data-lucide="sparkles"></i>
                            <span id="job-ai-result-title">AI Generated</span>
                        </span>
                        <button class="copy-btn" onclick="copyResult('job-ai-result-content')">
                            <i class="fas fa-copy"></i> Copy
                        </button>
                    </div>
                    <div class="ai-result-content" id="job-ai-result-content"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- Job Share Modal -->
    <div class="modal-overlay" id="job-share-overlay" onclick="closeJobShareModal()"></div>
    <div class="job-share-modal" id="job-share-modal">
        <div class="job-share-modal-header">
            <h3 class="job-share-modal-title">Share this job</h3>
            <button class="job-share-modal-close" onclick="closeJobShareModal()">
                <i class="fas fa-times"></i>
            </button>
        </div>
        <div class="job-share-options">
            <div class="job-share-option" onclick="shareJob('whatsapp')">
                <div class="job-share-option-icon" style="background: #25D366;">
                    <i class="fab fa-whatsapp"></i>
                </div>
                <span class="job-share-option-label">WhatsApp</span>
            </div>
            <div class="job-share-option" onclick="shareJob('facebook')">
                <div class="job-share-option-icon" style="background: #1877F2;">
                    <i class="fab fa-facebook-f"></i>
                </div>
                <span class="job-share-option-label">Facebook</span>
            </div>
            <div class="job-share-option" onclick="shareJob('twitter')">
                <div class="job-share-option-icon" style="background: #000000;">
                    <i class="fab fa-x-twitter"></i>
                </div>
                <span class="job-share-option-label">X</span>
            </div>
            <div class="job-share-option" onclick="shareJob('linkedin')">
                <div class="job-share-option-icon" style="background: #0A66C2;">
                    <i class="fab fa-linkedin-in"></i>
                </div>
                <span class="job-share-option-label">LinkedIn</span>
            </div>
        </div>
    </div>

    <!-- Custom Alert -->
    <div class="custom-alert" id="custom-alert">
        <div class="custom-alert-content">
            <div class="custom-alert-icon">
                <i class="fas fa-check"></i>
            </div>
            <h3 class="custom-alert-title" id="alert-title">Success</h3>
            <p class="custom-alert-message" id="alert-message">Operation completed successfully.</p>
            <button class="custom-alert-btn" onclick="closeAlert()">Got it</button>
        </div>
    </div>

    <audio id="radio-player" style="display: none;"></audio>

    <!-- FAB for Jobs Page -->
    <div class="fab-container" id="jobs-fab">
        <div class="fab-options" id="fab-options">
            <div class="fab-option" onclick="openCVBuilder()">
                <div class="fab-option-icon cv">
                    <i class="fas fa-file-alt"></i>
                </div>
                <div>
                    <div class="fab-option-text">AI CV Builder</div>
                    <div class="fab-option-desc">Create a professional CV</div>
                </div>
            </div>
            <div class="fab-option" onclick="openCoverLetterBuilder()">
                <div class="fab-option-icon cover">
                    <i class="fas fa-envelope-open-text"></i>
                </div>
                <div>
                    <div class="fab-option-text">Cover Letter</div>
                    <div class="fab-option-desc">Write a compelling letter</div>
                </div>
            </div>
            <div class="fab-option" onclick="openInterviewPrep()">
                <div class="fab-option-icon interview">
                    <i class="fas fa-comments"></i>
                </div>
                <div>
                    <div class="fab-option-text">Interview Prep</div>
                    <div class="fab-option-desc">Practice with AI</div>
                </div>
            </div>
        </div>
        <button class="fab-main" id="fab-main" onclick="toggleFab()">
            <i data-lucide="sparkles"></i>
        </button>
    </div>

    <!-- AI CV Builder Modal -->
    <div class="modal-overlay" id="cv-modal-overlay" onclick="closeCVBuilder()"></div>
    <div class="ai-tool-modal" id="cv-modal">
        <div class="modal-header">
            <button class="modal-close" onclick="closeCVBuilder()">
                <i class="fas fa-arrow-left"></i>
            </button>
            <span class="modal-title">AI CV Builder</span>
            <div style="width: 40px;"></div>
        </div>
        <div class="ai-tool-content">
            <h1 class="ai-tool-title">Build Your CV</h1>
            <p class="ai-tool-subtitle">Let AI help you create a professional CV tailored for your dream job</p>

            <div class="ai-tool-form">
                <div class="form-group">
                    <label class="form-label">Full Name</label>
                    <input type="text" class="form-input" id="cv-name" placeholder="e.g., John Moyo">
                </div>

                <div class="form-group">
                    <label class="form-label">Target Job Title</label>
                    <input type="text" class="form-input" id="cv-job" placeholder="e.g., Software Developer">
                </div>

                <div class="form-group">
                    <label class="form-label">Years of Experience</label>
                    <input type="text" class="form-input" id="cv-experience" placeholder="e.g., 3 years">
                </div>

                <div class="form-group">
                    <label class="form-label">Key Skills</label>
                    <input type="text" class="form-input" id="cv-skills" placeholder="e.g., JavaScript, React, Node.js, SQL">
                    <span class="form-hint">Separate skills with commas</span>
                </div>

                <div class="form-group">
                    <label class="form-label">Education</label>
                    <input type="text" class="form-input" id="cv-education" placeholder="e.g., BSc Computer Science, University of Zimbabwe">
                </div>

                <div class="form-group">
                    <label class="form-label">Work Experience Summary</label>
                    <textarea class="form-input form-textarea" id="cv-work" placeholder="Briefly describe your work history..."></textarea>
                </div>

                <button class="ai-generate-btn" id="cv-generate-btn" onclick="generateCV()">
                    <i data-lucide="sparkles"></i>
                    Generate CV
                </button>

                <div class="ai-result-box" id="cv-result">
                    <div class="ai-result-header">
                        <span class="ai-result-title">
                            <i data-lucide="sparkles"></i>
                            Generated CV
                        </span>
                        <button class="copy-btn" onclick="copyResult('cv-result-content')">
                            <i class="fas fa-copy"></i> Copy
                        </button>
                    </div>
                    <div class="ai-result-content" id="cv-result-content"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- AI Cover Letter Modal -->
    <div class="modal-overlay" id="cover-modal-overlay" onclick="closeCoverLetterBuilder()"></div>
    <div class="ai-tool-modal" id="cover-modal">
        <div class="modal-header">
            <button class="modal-close" onclick="closeCoverLetterBuilder()">
                <i class="fas fa-arrow-left"></i>
            </button>
            <span class="modal-title">Cover Letter</span>
            <div style="width: 40px;"></div>
        </div>
        <div class="ai-tool-content">
            <h1 class="ai-tool-title">Write a Cover Letter</h1>
            <p class="ai-tool-subtitle">Let AI craft a compelling cover letter that gets you noticed</p>

            <div class="ai-tool-form">
                <div class="form-group">
                    <label class="form-label">Your Name</label>
                    <input type="text" class="form-input" id="cover-name" placeholder="e.g., John Moyo">
                </div>

                <div class="form-group">
                    <label class="form-label">Job Title Applying For</label>
                    <input type="text" class="form-input" id="cover-job" placeholder="e.g., Marketing Manager">
                </div>

                <div class="form-group">
                    <label class="form-label">Company Name</label>
                    <input type="text" class="form-input" id="cover-company" placeholder="e.g., Delta Corporation">
                </div>

                <div class="form-group">
                    <label class="form-label">Your Key Skills & Strengths</label>
                    <input type="text" class="form-input" id="cover-skills" placeholder="e.g., Leadership, Digital Marketing, Team Management">
                </div>

                <div class="form-group">
                    <label class="form-label">Years of Relevant Experience</label>
                    <input type="text" class="form-input" id="cover-experience" placeholder="e.g., 5 years">
                </div>

                <div class="form-group">
                    <label class="form-label">Why do you want this job? (Optional)</label>
                    <textarea class="form-input form-textarea" id="cover-why" placeholder="Share your motivation..."></textarea>
                </div>

                <button class="ai-generate-btn" id="cover-generate-btn" onclick="generateCoverLetterFAB()">
                    <i data-lucide="sparkles"></i>
                    Generate Cover Letter
                </button>

                <div class="ai-result-box" id="cover-result">
                    <div class="ai-result-header">
                        <span class="ai-result-title">
                            <i data-lucide="sparkles"></i>
                            Your Cover Letter
                        </span>
                        <button class="copy-btn" onclick="copyResult('cover-result-content')">
                            <i class="fas fa-copy"></i> Copy
                        </button>
                    </div>
                    <div class="ai-result-content" id="cover-result-content"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- Auth Modal -->
    <div class="modal-overlay" id="auth-modal-overlay" onclick="closeAuthModal()"></div>
    <div class="ai-tool-modal" id="auth-modal">
        <div class="modal-header">
            <button class="modal-close" onclick="closeAuthModal()">
                <i class="fas fa-arrow-left"></i>
            </button>
            <span class="modal-title" id="auth-modal-title">Sign In</span>
            <div style="width: 40px;"></div>
        </div>
        <div class="ai-tool-content">
            <!-- Sign In Form -->
            <div id="signin-form">
                <h1 class="ai-tool-title">Welcome Back</h1>
                <p class="ai-tool-subtitle">Sign in to your iNasi account</p>

                <div class="ai-tool-form">
                    <div class="form-group">
                        <label class="form-label">Email Address</label>
                        <input type="email" class="form-input" id="signin-email" placeholder="your@email.com">
                    </div>

                    <div class="form-group">
                        <label class="form-label">Password</label>
                        <input type="password" class="form-input" id="signin-password" placeholder="">
                    </div>

                    <button class="ai-generate-btn" onclick="signIn()">
                        <i class="fas fa-sign-in-alt"></i>
                        Sign In
                    </button>

                    <p style="text-align: center; margin: 16px 0; color: var(--text-secondary); font-size: 14px;">
                        Don't have an account?
                        <a style="color: var(--zim-green); cursor: pointer; font-weight: 600;" onclick="showSignUp()">Sign Up</a>
                    </p>
                </div>
            </div>

            <!-- Sign Up Form -->
            <div id="signup-form" style="display: none;">
                <h1 class="ai-tool-title">Create Account</h1>
                <p class="ai-tool-subtitle">Join iNasi today</p>

                <div class="ai-tool-form">
                    <div class="form-group">
                        <label class="form-label">Full Name</label>
                        <input type="text" class="form-input" id="signup-name" placeholder="John Moyo">
                    </div>

                    <div class="form-group">
                        <label class="form-label">Email Address</label>
                        <input type="email" class="form-input" id="signup-email" placeholder="your@email.com">
                    </div>

                    <div class="form-group">
                        <label class="form-label">Phone Number</label>
                        <input type="tel" class="form-input" id="signup-phone" placeholder="+263 77 123 4567">
                    </div>

                    <div class="form-group">
                        <label class="form-label">Password</label>
                        <input type="password" class="form-input" id="signup-password" placeholder="">
                    </div>

                    <div class="form-group">
                        <label class="form-label">Confirm Password</label>
                        <input type="password" class="form-input" id="signup-confirm" placeholder="">
                    </div>

                    <button class="ai-generate-btn" onclick="signUp()">
                        <i class="fas fa-user-plus"></i>
                        Create Account
                    </button>

                    <p style="text-align: center; margin: 16px 0; color: var(--text-secondary); font-size: 14px;">
                        Already have an account?
                        <a style="color: var(--zim-green); cursor: pointer; font-weight: 600;" onclick="showSignIn()">Sign In</a>
                    </p>
                </div>
            </div>
        </div>
    </div>

    <!-- OTP Verification Modal -->
    <div class="modal-overlay" id="otp-modal-overlay" onclick="closeOTPModal()"></div>
    <div class="ai-tool-modal" id="otp-modal">
        <div class="modal-header">
            <button class="modal-close" onclick="closeOTPModal()">
                <i class="fas fa-arrow-left"></i>
            </button>
            <span class="modal-title">Verify Email</span>
            <div style="width: 40px;"></div>
        </div>
        <div class="ai-tool-content">
            <h1 class="ai-tool-title">Verify Your Email</h1>
            <p class="ai-tool-subtitle">Enter the 4-digit code sent to <span id="otp-email"></span></p>

            <div class="ai-tool-form">
                <div class="form-group">
                    <label class="form-label">OTP Code</label>
                    <div style="display: flex; gap: 10px; justify-content: center;">
                        <input type="text" class="form-input" id="otp-1" maxlength="1" style="text-align: center; width: 50px; font-size: 24px;" oninput="moveToNext(1)">
                        <input type="text" class="form-input" id="otp-2" maxlength="1" style="text-align: center; width: 50px; font-size: 24px;" oninput="moveToNext(2)">
                        <input type="text" class="form-input" id="otp-3" maxlength="1" style="text-align: center; width: 50px; font-size: 24px;" oninput="moveToNext(3)">
                        <input type="text" class="form-input" id="otp-4" maxlength="1" style="text-align: center; width: 50px; font-size: 24px;" oninput="moveToNext(4)">
                    </div>
                </div>

                <p style="text-align: center; font-size: 12px; color: var(--text-secondary); margin: 16px 0;">
                    <i class="fas fa-info-circle" style="margin-right: 4px;"></i>
                    For demo purposes, use code: <strong>0000</strong>
                </p>

                <button class="ai-generate-btn" onclick="verifyOTP()">
                    <i class="fas fa-check-circle"></i>
                    Verify & Continue
                </button>

                <p style="text-align: center; margin-top: 16px; font-size: 14px; color: var(--text-secondary);">
                    Didn't receive code?
                    <a style="color: var(--zim-green); cursor: pointer;" onclick="resendOTP()">Resend</a>
                </p>
            </div>
        </div>
    </div>

    <!-- Edit Profile Modal -->
    <div class="modal-overlay" id="edit-profile-overlay" onclick="closeEditProfile()"></div>
    <div class="ai-tool-modal" id="edit-profile-modal">
        <div class="modal-header">
            <button class="modal-close" onclick="closeEditProfile()">
                <i class="fas fa-arrow-left"></i>
            </button>
            <span class="modal-title">Edit Profile</span>
            <div style="width: 40px;"></div>
        </div>
        <div class="ai-tool-content">
            <h1 class="ai-tool-title">Update Profile</h1>
            <p class="ai-tool-subtitle">Manage your personal information</p>

            <div class="ai-tool-form">
                <div class="form-group">
                    <label class="form-label">Full Name</label>
                    <input type="text" class="form-input" id="edit-name" placeholder="John Moyo">
                </div>

                <div class="form-group">
                    <label class="form-label">Email Address</label>
                    <input type="email" class="form-input" id="edit-email" placeholder="your@email.com" disabled>
                </div>

                <div class="form-group">
                    <label class="form-label">Phone Number</label>
                    <input type="tel" class="form-input" id="edit-phone" placeholder="+263 77 123 4567">
                </div>

                <div class="form-group">
                    <label class="form-label">Location</label>
                    <input type="text" class="form-input" id="edit-location" placeholder="Harare, Zimbabwe">
                </div>

                <div class="form-group">
                    <label class="form-label">Bio</label>
                    <textarea class="form-input form-textarea" id="edit-bio" placeholder="Tell us about yourself..."></textarea>
                </div>

                <button class="ai-generate-btn" onclick="saveProfile()">
                    <i class="fas fa-save"></i>
                    Save Changes
                </button>
            </div>
        </div>
    </div>

    <!-- AI Interview Prep Modal -->
    <div class="modal-overlay" id="interview-modal-overlay" onclick="closeInterviewPrep()"></div>
    <div class="ai-tool-modal" id="interview-modal">
        <div class="modal-header">
            <button class="modal-close" onclick="closeInterviewPrep()">
                <i class="fas fa-arrow-left"></i>
            </button>
            <span class="modal-title">Interview Prep</span>
            <div style="width: 40px;"></div>
        </div>
        <div class="ai-tool-content">
            <h1 class="ai-tool-title">Interview Preparation</h1>
            <p class="ai-tool-subtitle">Get AI-generated interview questions and tips for your target role</p>

            <div class="ai-tool-form">
                <div class="form-group">
                    <label class="form-label">Job Title You're Applying For</label>
                    <input type="text" class="form-input" id="interview-job" placeholder="e.g., Marketing Manager">
                </div>

                <div class="form-group">
                    <label class="form-label">Company (Optional)</label>
                    <input type="text" class="form-input" id="interview-company" placeholder="e.g., Delta Corporation">
                </div>

                <div class="form-group">
                    <label class="form-label">Industry</label>
                    <input type="text" class="form-input" id="interview-industry" placeholder="e.g., FMCG, Banking, Technology">
                </div>

                <div class="form-group">
                    <label class="form-label">Your Experience Level</label>
                    <select class="form-input" id="interview-level">
                        <option value="entry">Entry Level (0-2 years)</option>
                        <option value="mid">Mid Level (3-5 years)</option>
                        <option value="senior">Senior Level (5+ years)</option>
                        <option value="manager">Management</option>
                    </select>
                </div>

                <div class="form-group">
                    <label class="form-label">What would you like help with?</label>
                    <select class="form-input" id="interview-type">
                        <option value="questions">Common Interview Questions</option>
                        <option value="behavioral">Behavioral Questions (STAR Method)</option>
                        <option value="technical">Technical Questions</option>
                        <option value="tips">General Interview Tips</option>
                    </select>
                </div>

                <button class="ai-generate-btn" id="interview-generate-btn" onclick="generateInterviewPrep()">
                    <i data-lucide="sparkles"></i>
                    Generate Prep Material
                </button>

                <div class="ai-result-box" id="interview-result">
                    <div class="ai-result-header">
                        <span class="ai-result-title">
                            <i data-lucide="sparkles"></i>
                            Interview Prep
                        </span>
                        <button class="copy-btn" onclick="copyResult('interview-result-content')">
                            <i class="fas fa-copy"></i> Copy
                        </button>
                    </div>
                    <div class="ai-result-content" id="interview-result-content"></div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // =============================================
        // CONFIGURATION
        // =============================================
        const API_BASE_URL = 'https://inasi-backend.onrender.com/api';
        const ITEMS_PER_PAGE = 10;

        // =============================================
        // STATE MANAGEMENT
        // =============================================
        let currentUser = null;
        let newsData = [];
        let jobsData = [];
        let radioStations = [];
        let currentArticle = null;
        let currentJob = null;
        let currentRadio = null;
        let ratesChart = null;
        let currentChartPeriod = '7d';
        let newsCurrentPage = 1;
        let jobsCurrentPage = 1;
        let savedJobs = new Set();
        let fabOpen = false;
        let userToggledTheme = false;

        // Exchange rate data (temporary - would come from API)
        const exchangeRatesData = {
            'USD/ZWG': { rate: 27.50, change: 0.12 },
            'ZAR/USD': { rate: 18.20, change: -0.25 },
            'BWP/USD': { rate: 13.60, change: 0.08 },
            'ZAR/BWP': { rate: 1.34, change: 0.10 }
        };

        // Historical rate data for chart
        const historicalRates = {
            '7d': {
                labels: ['Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat', 'Sun'],
                zwg: [27.2, 27.3, 27.4, 27.35, 27.45, 27.48, 27.50],
                zar: [18.1, 18.15, 18.22, 18.18, 18.25, 18.20, 18.20],
                bwp: [13.5, 13.52, 13.55, 13.58, 13.55, 13.58, 13.60]
            },
            '30d': {
                labels: ['Week 1', 'Week 2', 'Week 3', 'Week 4'],
                zwg: [26.8, 27.0, 27.3, 27.50],
                zar: [17.9, 18.0, 18.15, 18.20],
                bwp: [13.3, 13.4, 13.5, 13.60]
            }
        };

        // =============================================
        // API SERVICE FUNCTIONS
        // =============================================
        class ApiService {
            static getAuthHeader() {
                const token = localStorage.getItem('token');
                return token ? { 'Authorization': `Bearer ${token}` } : {};
            }

            static async get(url, params = {}) {
                try {
                    const queryString = Object.keys(params).length 
                        ? '?' + new URLSearchParams(params).toString() 
                        : '';
                    const response = await fetch(`${API_BASE_URL}${url}${queryString}`, {
                        headers: {
                            'Content-Type': 'application/json',
                            ...this.getAuthHeader()
                        }
                    });
                    
                    if (!response.ok) {
                        throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                    }
                    
                    return await response.json();
                } catch (error) {
                    console.error(`API GET Error (${url}):`, error);
                    throw error;
                }
            }

            static async post(url, data = {}) {
                try {
                    const response = await fetch(`${API_BASE_URL}${url}`, {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                            ...this.getAuthHeader()
                        },
                        body: JSON.stringify(data)
                    });
                    
                    const result = await response.json();
                    
                    if (!response.ok) {
                        throw new Error(result.message || `HTTP ${response.status}`);
                    }
                    
                    return result;
                } catch (error) {
                    console.error(`API POST Error (${url}):`, error);
                    throw error;
                }
            }

            static async put(url, data = {}) {
                try {
                    const response = await fetch(`${API_BASE_URL}${url}`, {
                        method: 'PUT',
                        headers: {
                            'Content-Type': 'application/json',
                            ...this.getAuthHeader()
                        },
                        body: JSON.stringify(data)
                    });
                    
                    const result = await response.json();
                    
                    if (!response.ok) {
                        throw new Error(result.message || `HTTP ${response.status}`);
                    }
                    
                    return result;
                } catch (error) {
                    console.error(`API PUT Error (${url}):`, error);
                    throw error;
                }
            }
        }

        // =============================================
        // INITIALIZATION
        // =============================================
        document.addEventListener('DOMContentLoaded', () => {
            initTheme();
            setCurrentDate();
            checkAuthStatus();
            loadInitialData();
            setupEventListeners();
        });

        function initTheme() {
            if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
                document.documentElement.classList.add('dark');
            }
            updateThemeSwitch();
        }

        function setCurrentDate() {
            const now = new Date();
            document.getElementById('headerDate').textContent = now.toLocaleDateString('en-ZW', {
                weekday: 'short',
                day: 'numeric',
                month: 'short',
                year: 'numeric'
            });
        }

        function checkAuthStatus() {
            const token = localStorage.getItem('token');
            const user = localStorage.getItem('user');
            
            if (token && user) {
                try {
                    currentUser = JSON.parse(user);
                    updateProfileUI();
                } catch (e) {
                    console.error('Error parsing user data:', e);
                    localStorage.removeItem('token');
                    localStorage.removeItem('user');
                }
            }
        }

        async function loadInitialData() {
            try {
                await Promise.all([
                    loadNews(),
                    loadJobs(),
                    loadRadioStations()
                ]);
                renderHomeContent();
            } catch (error) {
                console.error('Error loading initial data:', error);
                showAlert('Data Loading Error', 'Failed to load data. Please check your connection and make sure the backend is running.');
            }
        }

        function setupEventListeners() {
            document.getElementById('themeToggle').addEventListener('click', toggleTheme);
            setupTabs();
            
            // Listen for system theme changes
            window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', event => {
                if (!userToggledTheme) {
                    if (event.matches) {
                        document.documentElement.classList.add('dark');
                    } else {
                        document.documentElement.classList.remove('dark');
                    }
                    updateThemeSwitch();
                }
            });
        }

        // =============================================
        // DATA LOADING FUNCTIONS
        // =============================================
        async function loadNews() {
            try {
                const response = await ApiService.get('/news');
                if (response.success) {
                    newsData = response.data.news || [];
                }
            } catch (error) {
                console.error('Error loading news:', error);
                newsData = getFallbackNews();
            }
        }

        async function loadJobs() {
            try {
                const response = await ApiService.get('/jobs');
                if (response.success) {
                    jobsData = response.data.jobs || [];
                }
            } catch (error) {
                console.error('Error loading jobs:', error);
                jobsData = getFallbackJobs();
            }
        }

        async function loadRadioStations() {
            try {
                const response = await ApiService.get('/radio');
                if (response.success) {
                    radioStations = response.data.stations || [];
                }
            } catch (error) {
                console.error('Error loading radio stations:', error);
                radioStations = getFallbackRadioStations();
            }
        }

        function getFallbackNews() {
            return [
                {
                    id: 1,
                    category: 'general',
                    title: 'Welcome to iNasi',
                    excerpt: 'Your Zimbabwean portal for news, jobs, and more.',
                    content: 'iNasi brings you the latest news, job opportunities, and information from Zimbabwe.',
                    source: 'iNasi',
                    date: new Date(),
                    isFeatured: true
                }
            ];
        }

        function getFallbackJobs() {
            return [
                {
                    id: 1,
                    title: 'Job Portal',
                    company: 'iNasi',
                    location: 'Zimbabwe',
                    jobType: 'fulltime',
                    salary: 'Competitive',
                    tags: ['Portal', 'Zimbabwe'],
                    description: 'Check back soon for real job listings from Zimbabwean companies.'
                }
            ];
        }

        function getFallbackRadioStations() {
            return [
                {
                    id: 1,
                    name: 'Radio Zimbabwe',
                    frequency: '96.0 FM',
                    streamUrl: 'http://154.120.239.26:8040/nhepfenuro.mp3',
                    category: 'national',
                    location: 'Nationwide'
                }
            ];
        }

        // =============================================
        // RENDERING FUNCTIONS
        // =============================================
        function renderHomeContent() {
            renderFeaturedNews();
            renderHomeNews();
            renderHomeJobs();
            renderHomeRadio();
            renderHomeRates();
        }

        function renderFeaturedNews() {
            if (newsData.length > 0) {
                const featuredNews = newsData.find(n => n.isFeatured) || newsData[0];
                document.getElementById('featured-title').textContent = featuredNews.title;
            }
        }

        function renderHomeNews() {
            const container = document.getElementById('home-news-list');
            if (newsData.length > 0) {
                const homeNews = newsData.slice(0, 3);
                container.innerHTML = homeNews.map((news, index) => generateNewsCard(news, index)).join('');
            } else {
                container.innerHTML = '<div class="card"><p>Loading news...</p></div>';
            }
        }

        function renderHomeJobs() {
            const container = document.getElementById('home-jobs-list');
            if (jobsData.length > 0) {
                const homeJobs = jobsData.slice(0, 3);
                container.innerHTML = homeJobs.map(job => generateJobCard(job)).join('');
            } else {
                container.innerHTML = '<div class="card"><p>Loading jobs...</p></div>';
            }
        }

        function renderHomeRadio() {
            const container = document.getElementById('home-radio-list');
            if (radioStations.length > 0) {
                const homeRadio = radioStations.slice(0, 5);
                container.innerHTML = homeRadio.map(station => generateRadioScrollCard(station)).join('');
            } else {
                container.innerHTML = '<div class="card"><p>Loading radio stations...</p></div>';
            }
        }

        function renderHomeRates() {
            // This would ideally come from an API
            document.getElementById('home-usd').textContent = exchangeRatesData['USD/ZWG'].rate.toFixed(1);
            document.getElementById('home-zar-usd').textContent = exchangeRatesData['ZAR/USD'].rate.toFixed(1);
            document.getElementById('home-bwp-usd').textContent = exchangeRatesData['BWP/USD'].rate.toFixed(1);
        }

        function renderNews(filter = 'all', search = '', page = 1) {
            const container = document.getElementById('news-list');
            const paginationContainer = document.getElementById('news-pagination');
            
            let filtered = [...newsData];
            
            if (filter !== 'all') {
                filtered = filtered.filter(n => n.category === filter);
            }
            
            if (search) {
                const searchLower = search.toLowerCase();
                filtered = filtered.filter(n =>
                    n.title.toLowerCase().includes(searchLower) ||
                    n.description.toLowerCase().includes(searchLower) ||
                    (n.content && n.content.toLowerCase().includes(searchLower))
                );
            }
            
            if (filtered.length === 0) {
                container.innerHTML = `
                    <div class="empty-state">
                        <i class="fas fa-newspaper"></i>
                        <h3>No news found</h3>
                        <p>Try a different search or category</p>
                    </div>
                `;
                paginationContainer.innerHTML = '';
                return;
            }
            
            const totalPages = Math.ceil(filtered.length / ITEMS_PER_PAGE);
            newsCurrentPage = Math.min(page, totalPages);
            const startIndex = (newsCurrentPage - 1) * ITEMS_PER_PAGE;
            const endIndex = startIndex + ITEMS_PER_PAGE;
            const paginatedNews = filtered.slice(startIndex, endIndex);
            
            container.innerHTML = paginatedNews.map((news, idx) => generateNewsCard(news, startIndex + idx)).join('');
            renderNewsPagination(totalPages, filter, search);
        }

        function renderNewsPagination(totalPages, filter, search) {
            const container = document.getElementById('news-pagination');
            
            if (totalPages <= 1) {
                container.innerHTML = '';
                return;
            }
            
            let html = `
                <button class="pagination-arrow" onclick="changeNewsPage(${newsCurrentPage - 1}, '${filter}', '${search}')" ${newsCurrentPage === 1 ? 'disabled' : ''}>
                    <i class="fas fa-chevron-left"></i>
                </button>
            `;
            
            const maxVisiblePages = 5;
            let startPage = Math.max(1, newsCurrentPage - Math.floor(maxVisiblePages / 2));
            let endPage = Math.min(totalPages, startPage + maxVisiblePages - 1);
            
            if (endPage - startPage + 1 < maxVisiblePages) {
                startPage = Math.max(1, endPage - maxVisiblePages + 1);
            }
            
            for (let i = startPage; i <= endPage; i++) {
                html += `
                    <button class="pagination-btn ${i === newsCurrentPage ? 'active' : ''}" onclick="changeNewsPage(${i}, '${filter}', '${search}')">
                        ${i}
                    </button>
                `;
            }
            
            html += `
                <button class="pagination-arrow" onclick="changeNewsPage(${newsCurrentPage + 1}, '${filter}', '${search}')" ${newsCurrentPage === totalPages ? 'disabled' : ''}>
                    <i class="fas fa-chevron-right"></i>
                </button>
            `;
            
            container.innerHTML = html;
        }

        function renderJobs(filter = 'all', search = '', page = 1) {
            const container = document.getElementById('jobs-list');
            const paginationContainer = document.getElementById('jobs-pagination');
            
            let filtered = [...jobsData];
            
            if (filter !== 'all') {
                filtered = filtered.filter(j => j.jobType === filter);
            }
            
            if (search) {
                const searchLower = search.toLowerCase();
                filtered = filtered.filter(j =>
                    j.title.toLowerCase().includes(searchLower) ||
                    j.company.toLowerCase().includes(searchLower) ||
                    (j.tags && j.tags.some(t => t.toLowerCase().includes(searchLower)))
                );
            }
            
            if (filtered.length === 0) {
                container.innerHTML = `
                    <div class="empty-state">
                        <i class="fas fa-briefcase"></i>
                        <h3>No jobs found</h3>
                        <p>Try a different search or filter</p>
                    </div>
                `;
                paginationContainer.innerHTML = '';
                return;
            }
            
            const totalPages = Math.ceil(filtered.length / ITEMS_PER_PAGE);
            jobsCurrentPage = Math.min(page, totalPages);
            const startIndex = (jobsCurrentPage - 1) * ITEMS_PER_PAGE;
            const endIndex = startIndex + ITEMS_PER_PAGE;
            const paginatedJobs = filtered.slice(startIndex, endIndex);
            
            container.innerHTML = paginatedJobs.map(job => generateJobCard(job)).join('');
            renderJobsPagination(totalPages, filter, search);
        }

        function renderJobsPagination(totalPages, filter, search) {
            const container = document.getElementById('jobs-pagination');
            
            if (totalPages <= 1) {
                container.innerHTML = '';
                return;
            }
            
            let html = `
                <button class="pagination-arrow" onclick="changeJobsPage(${jobsCurrentPage - 1}, '${filter}', '${search}')" ${jobsCurrentPage === 1 ? 'disabled' : ''}>
                    <i class="fas fa-chevron-left"></i>
                </button>
            `;
            
            const maxVisiblePages = 5;
            let startPage = Math.max(1, jobsCurrentPage - Math.floor(maxVisiblePages / 2));
            let endPage = Math.min(totalPages, startPage + maxVisiblePages - 1);
            
            if (endPage - startPage + 1 < maxVisiblePages) {
                startPage = Math.max(1, endPage - maxVisiblePages + 1);
            }
            
            for (let i = startPage; i <= endPage; i++) {
                html += `
                    <button class="pagination-btn ${i === jobsCurrentPage ? 'active' : ''}" onclick="changeJobsPage(${i}, '${filter}', '${search}')">
                        ${i}
                    </button>
                `;
            }
            
            html += `
                <button class="pagination-arrow" onclick="changeJobsPage(${jobsCurrentPage + 1}, '${filter}', '${search}')" ${jobsCurrentPage === totalPages ? 'disabled' : ''}>
                    <i class="fas fa-chevron-right"></i>
                </button>
            `;
            
            container.innerHTML = html;
        }

        function renderRadio(filter = 'all') {
            const container = document.getElementById('radio-list');
            let filtered = [...radioStations];
            
            if (filter !== 'all') {
                filtered = filtered.filter(s => s.category === filter);
            }
            
            container.innerHTML = filtered.map(station => generateRadioCard(station)).join('');
        }

        // =============================================
        // CARD GENERATION FUNCTIONS
        // =============================================
        const categoryIcons = {
            'politics': 'fa-landmark',
            'business': 'fa-chart-line',
            'sports': 'fa-futbol',
            'entertainment': 'fa-music',
            'general': 'fa-newspaper',
            'local': 'fa-map-marker-alt'
        };

        const categoryColors = {
            'politics': 'linear-gradient(135deg, #1e3a5f 0%, #2d5a87 100%)',
            'business': 'linear-gradient(135deg, #319F43 0%, #257a33 100%)',
            'sports': 'linear-gradient(135deg, #DE2010 0%, #a5150c 100%)',
            'entertainment': 'linear-gradient(135deg, #9333EA 0%, #7c22cb 100%)',
            'general': 'linear-gradient(135deg, #3B82F6 0%, #1d4ed8 100%)',
            'local': 'linear-gradient(135deg, #F59E0B 0%, #d97706 100%)'
        };

        function generateNewsCard(news, index) {
            const category = news.category || 'general';
            const bgStyle = `background: ${categoryColors[category] || 'linear-gradient(135deg, var(--zim-green), #257a33)'};`;
            const icon = categoryIcons[category] || 'fa-newspaper';
            const time = formatTime(news.date || news.createdAt);

            return `
                <div class="card news-card-with-image" onclick="openArticle(${index})">
                    <div class="news-image" style="${bgStyle}">
                        <i class="fas ${icon} news-image-icon"></i>
                        <span class="news-image-category">${category}</span>
                    </div>
                    <div class="news-card-content">
                        <h3 class="news-title">${news.title}</h3>
                        <p class="news-excerpt">${news.description || news.excerpt || ''}</p>
                        <div class="news-meta">
                            <span class="news-source">
                                <span class="source-dot"></span>
                                ${news.source || 'News Source'}
                            </span>
                            <span>${time}</span>
                        </div>
                    </div>
                </div>
            `;
        }

        function generateJobCard(job) {
            const typeLabels = {
                'fulltime': 'Full-time',
                'parttime': 'Part-time',
                'remote': 'Remote',
                'contract': 'Contract'
            };
            
            return `
                <div class="card job-card" onclick="openJob('${job.id}')" style="cursor: pointer;">
                    <div class="job-logo">${job.company.charAt(0)}</div>
                    <div class="job-info">
                        <h3 class="job-title">${job.title}</h3>
                        <p class="job-company">${job.company}  ${job.location}</p>
                        <div class="job-tags">
                            <span class="job-tag">${typeLabels[job.jobType] || job.jobType}</span>
                            ${(job.tags || []).slice(0, 2).map(tag => `<span class="job-tag">${tag}</span>`).join('')}
                        </div>
                        <p style="font-size: 11px; color: var(--text-secondary); margin-top: 8px;">
                            <i class="fas fa-clock" style="margin-right: 4px;"></i>${formatTime(job.createdAt)}
                        </p>
                    </div>
                </div>
            `;
        }

        function generateRadioCard(station) {
            const categoryColors = {
                'national': 'linear-gradient(135deg, #319F43, #257a33)',
                'commercial': 'linear-gradient(135deg, #3B82F6, #1d4ed8)',
                'community': 'linear-gradient(135deg, #F59E0B, #d97706)',
                'university': 'linear-gradient(135deg, #8B5CF6, #6D28D9)'
            };
            
            const categoryIcons = {
                'national': 'fa-landmark',
                'commercial': 'fa-broadcast-tower',
                'community': 'fa-users',
                'university': 'fa-graduation-cap'
            };
            
            return `
                <div class="card radio-card">
                    <div class="radio-cover" style="background: ${categoryColors[station.category] || 'linear-gradient(135deg, var(--zim-red), #a5150c)'}">
                        <i class="fas ${categoryIcons[station.category] || 'fa-radio'}"></i>
                    </div>
                    <div class="radio-info">
                        <h3 class="radio-name">${station.name}</h3>
                        <p class="radio-freq">${station.frequency}</p>
                    </div>
                    <button class="radio-play-btn ${currentRadio === station.id ? 'playing' : ''}" onclick="toggleRadio('${station.id}', '${station.name}', '${station.streamUrl}')">
                        <i class="fas ${currentRadio === station.id ? 'fa-pause' : 'fa-play'}"></i>
                    </button>
                </div>
            `;
        }

        function generateRadioScrollCard(station) {
            const categoryColors = {
                'national': 'linear-gradient(135deg, #319F43, #257a33)',
                'commercial': 'linear-gradient(135deg, #3B82F6, #1d4ed8)',
                'community': 'linear-gradient(135deg, #F59E0B, #d97706)',
                'university': 'linear-gradient(135deg, #8B5CF6, #6D28D9)'
            };
            
            return `
                <div class="radio-scroll-card">
                    <div class="radio-scroll-icon" style="background: ${categoryColors[station.category] || 'linear-gradient(135deg, var(--zim-red), #a5150c)'}">
                        <i class="fas fa-broadcast-tower"></i>
                    </div>
                    <h3 class="radio-scroll-name">${station.name}</h3>
                    <p class="radio-scroll-freq">${station.frequency}</p>
                    <button class="radio-listen-btn ${currentRadio === station.id ? 'playing' : ''}" onclick="toggleRadio('${station.id}', '${station.name}', '${station.streamUrl}')">
                        <i class="fas ${currentRadio === station.id ? 'fa-pause' : 'fa-play'}"></i>
                        ${currentRadio === station.id ? 'Playing' : 'Listen Now'}
                    </button>
                </div>
            `;
        }

        // =============================================
        // UTILITY FUNCTIONS
        // =============================================
        function formatTime(dateString) {
            if (!dateString) return 'Recently';
            
            const date = new Date(dateString);
            const now = new Date();
            const diffMs = now - date;
            const diffHours = Math.floor(diffMs / (1000 * 60 * 60));
            
            if (diffHours < 1) return 'Just now';
            if (diffHours < 24) return `${diffHours} hour${diffHours !== 1 ? 's' : ''} ago`;
            
            const diffDays = Math.floor(diffHours / 24);
            if (diffDays < 7) return `${diffDays} day${diffDays !== 1 ? 's' : ''} ago`;
            
            return date.toLocaleDateString('en-ZW', {
                day: 'numeric',
                month: 'short',
                year: now.getFullYear() !== date.getFullYear() ? 'numeric' : undefined
            });
        }

        function formatMarkdown(text) {
            if (!text) return '';
            
            return text
                .replace(/&/g, '&amp;')
                .replace(/</g, '&lt;')
                .replace(/>/g, '&gt;')
                .replace(/^### (.+)$/gm, '<h4 class="ai-heading">$1</h4>')
                .replace(/^## (.+)$/gm, '<h3 class="ai-heading">$1</h3>')
                .replace(/^# (.+)$/gm, '<h2 class="ai-heading">$1</h2>')
                .replace(/\*\*(.+?)\*\*/g, '<strong>$1</strong>')
                .replace(/__(.+?)__/g, '<strong>$1</strong>')
                .replace(/\*([^*]+)\*/g, '<em>$1</em>')
                .replace(/_([^_]+)_/g, '<em>$1</em>')
                .replace(/^[\-\*] (.+)$/gm, '<li>$1</li>')
                .replace(/^\d+\. (.+)$/gm, '<li>$1</li>')
                .replace(/(<li>.*<\/li>\n?)+/g, '<ul class="ai-list">$&</ul>')
                .replace(/\n\n/g, '</p><p>')
                .replace(/\n/g, '<br>')
                .replace(/^(.+)$/s, '<p>$1</p>')
                .replace(/<p><\/p>/g, '')
                .replace(/<p><br>/g, '<p>')
                .replace(/<br><\/p>/g, '</p>');
        }

        // =============================================
        // PAGE NAVIGATION
        // =============================================
        function showPage(pageName) {
            document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
            document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));
            
            document.getElementById(`page-${pageName}`).classList.add('active');
            document.querySelector(`.nav-item[data-page="${pageName}"]`).classList.add('active');
            
            const fab = document.getElementById('jobs-fab');
            if (pageName === 'jobs') {
                fab.classList.add('active');
                if (typeof lucide !== 'undefined') {
                    lucide.createIcons();
                }
            } else {
                fab.classList.remove('active');
                closeFab();
            }
            
            if (pageName === 'news') {
                renderNews();
            } else if (pageName === 'jobs') {
                renderJobs();
            } else if (pageName === 'radio') {
                renderRadio();
            }
            
            if (typeof lucide !== 'undefined') {
                setTimeout(() => lucide.createIcons(), 100);
            }
        }

        function changeNewsPage(page, filter, search) {
            newsCurrentPage = page;
            renderNews(filter, search, page);
            document.getElementById('page-news').scrollIntoView({ behavior: 'smooth' });
        }

        function changeJobsPage(page, filter, search) {
            jobsCurrentPage = page;
            renderJobs(filter, search, page);
            document.getElementById('page-jobs').scrollIntoView({ behavior: 'smooth' });
        }

        function filterNews() {
            const search = document.getElementById('news-search').value;
            const activeTab = document.querySelector('#news-tabs .tab.active');
            const category = activeTab ? activeTab.dataset.category : 'all';
            newsCurrentPage = 1;
            renderNews(category, search, 1);
        }

        function filterJobs() {
            const search = document.getElementById('job-search').value;
            const activeTab = document.querySelector('#job-tabs .tab.active');
            const type = activeTab ? activeTab.dataset.type : 'all';
            jobsCurrentPage = 1;
            renderJobs(type, search, 1);
        }

        // =============================================
        // TAB MANAGEMENT
        // =============================================
        function setupTabs() {
            document.querySelectorAll('#news-tabs .tab').forEach(tab => {
                tab.addEventListener('click', () => {
                    document.querySelectorAll('#news-tabs .tab').forEach(t => t.classList.remove('active'));
                    tab.classList.add('active');
                    newsCurrentPage = 1;
                    renderNews(tab.dataset.category, document.getElementById('news-search').value, 1);
                });
            });

            document.querySelectorAll('#job-tabs .tab').forEach(tab => {
                tab.addEventListener('click', () => {
                    document.querySelectorAll('#job-tabs .tab').forEach(t => t.classList.remove('active'));
                    tab.classList.add('active');
                    jobsCurrentPage = 1;
                    renderJobs(tab.dataset.type, document.getElementById('job-search').value, 1);
                });
            });

            document.querySelectorAll('#radio-tabs .tab').forEach(tab => {
                tab.addEventListener('click', () => {
                    document.querySelectorAll('#radio-tabs .tab').forEach(t => t.classList.remove('active'));
                    tab.classList.add('active');
                    renderRadio(tab.dataset.category);
                });
            });
        }

        // =============================================
        // THEME MANAGEMENT
        // =============================================
        function toggleTheme() {
            userToggledTheme = true;
            document.documentElement.classList.toggle('dark');
            updateThemeSwitch();
        }

        function updateThemeSwitch() {
            const circle = document.getElementById('theme-switch-circle');
            if (circle) {
                const isDark = document.documentElement.classList.contains('dark');
                circle.style.transform = isDark ? 'translateX(20px)' : 'translateX(2px)';
            }
        }

        // =============================================
        // ARTICLE FUNCTIONS
        // =============================================
        function openArticle(index) {
            if (index >= newsData.length) return;
            
            currentArticle = newsData[index];
            
            document.getElementById('article-category').textContent = currentArticle.category || 'general';
            document.getElementById('article-title').textContent = currentArticle.title;
            document.getElementById('article-source').textContent = currentArticle.source || 'News Source';
            document.getElementById('article-time').textContent = formatTime(currentArticle.date || currentArticle.createdAt);
            
            let content = currentArticle.content || currentArticle.description || 'Content not available';
            if (content.includes('\n')) {
                content = content.split('\n\n').map(p => `<p>${p}</p>`).join('');
            } else {
                content = `<p>${content}</p>`;
            }
            document.getElementById('article-body').innerHTML = content;

            const relatedContainer = document.getElementById('related-articles-list');
            const relatedArticles = newsData
                .filter((n, i) => i !== index && (n.category === currentArticle.category || i < 3))
                .slice(0, 3);
            
            if (relatedArticles.length === 0) {
                const otherArticles = newsData.filter((n, i) => i !== index).slice(0, 3);
                relatedContainer.innerHTML = otherArticles.map(article => generateRelatedArticleCard(article)).join('');
            } else {
                relatedContainer.innerHTML = relatedArticles.map(article => generateRelatedArticleCard(article)).join('');
            }

            document.getElementById('ai-output').classList.remove('active');
            document.querySelectorAll('.ai-option').forEach(btn => btn.classList.remove('active'));

            document.getElementById('modal-overlay').classList.add('active');
            document.getElementById('article-modal').classList.add('active');
            document.body.style.overflow = 'hidden';

            if (typeof lucide !== 'undefined') {
                lucide.createIcons();
            }
        }

        function generateRelatedArticleCard(article) {
            const articleIndex = newsData.findIndex(n => n.id === article.id);
            const bgStyle = `background: ${categoryColors[article.category] || 'linear-gradient(135deg, var(--zim-green), #257a33)'};`;
            const icon = categoryIcons[article.category] || 'fa-newspaper';

            return `
                <div class="related-article-card" onclick="openArticle(${articleIndex})">
                    <div class="related-article-image" style="${bgStyle}">
                        <i class="fas ${icon}"></i>
                    </div>
                    <div class="related-article-content">
                        <h4 class="related-article-title">${article.title}</h4>
                        <span class="related-article-meta">${article.source || 'Source'}  ${formatTime(article.date || article.createdAt)}</span>
                    </div>
                </div>
            `;
        }

        function shareArticle(platform) {
            if (!currentArticle) return;

            const title = encodeURIComponent(currentArticle.title);
            const text = encodeURIComponent(`${currentArticle.title} - ${currentArticle.description || ''}`);
            const url = encodeURIComponent(window.location.href);

            let shareUrl = '';

            switch (platform) {
                case 'facebook':
                    shareUrl = `https://www.facebook.com/sharer/sharer.php?quote=${title}`;
                    break;
                case 'twitter':
                    shareUrl = `https://twitter.com/intent/tweet?text=${text}`;
                    break;
                case 'linkedin':
                    shareUrl = `https://www.linkedin.com/sharing/share-offsite/?url=${url}`;
                    break;
                case 'whatsapp':
                    shareUrl = `https://wa.me/?text=${text}`;
                    break;
            }

            if (shareUrl) {
                window.open(shareUrl, '_blank', 'width=600,height=400');
            }
        }

        function closeArticle() {
            document.getElementById('modal-overlay').classList.remove('active');
            document.getElementById('article-modal').classList.remove('active');
            document.body.style.overflow = '';
            currentArticle = null;
        }

        // =============================================
        // JOB FUNCTIONS
        // =============================================
        function openJob(jobId) {
            currentJob = jobsData.find(j => j.id === jobId);
            if (!currentJob) return;

            document.getElementById('job-detail-logo').textContent = currentJob.company.charAt(0);
            document.getElementById('job-detail-title').textContent = currentJob.title;
            document.getElementById('job-detail-company').textContent = `${currentJob.company}  ${currentJob.location}`;
            
            const typeLabels = {
                'fulltime': 'Full-time',
                'parttime': 'Part-time',
                'remote': 'Remote',
                'contract': 'Contract'
            };
            
            document.getElementById('job-detail-type').textContent = typeLabels[currentJob.jobType] || currentJob.jobType;
            document.getElementById('job-detail-salary').textContent = currentJob.salary || 'Negotiable';
            document.getElementById('job-detail-posted').textContent = `Posted ${formatTime(currentJob.createdAt)}`;

            document.getElementById('job-detail-tags').innerHTML = (currentJob.tags || []).map(tag =>
                `<span class="job-detail-tag">${tag}</span>`
            ).join('');

            let description = currentJob.description || 'No description available';
            if (currentJob.duties) {
                description += `<div class="card" style="margin: 10px 0; padding: 15px; background: var(--bg-primary); border-radius: 8px;">
                    <h4 style="margin-bottom: 8px; color: var(--zim-green);">Duties & Responsibilities</h4>
                    ${currentJob.duties}
                </div>`;
            }
            
            if (currentJob.qualifications) {
                description += `<div class="card" style="margin: 10px 0; padding: 15px; background: var(--bg-primary); border-radius: 8px;">
                    <h4 style="margin-bottom: 8px; color: var(--zim-green);">Qualifications & Experience</h4>
                    ${currentJob.qualifications}
                </div>`;
            }
            
            if (currentJob.howToApply) {
                description += `<div class="card" style="margin: 10px 0; padding: 15px; background: var(--bg-primary); border-radius: 8px;">
                    <h4 style="margin-bottom: 8px; color: var(--zim-green);">How to Apply</h4>
                    ${currentJob.howToApply}
                </div>`;
            }

            document.getElementById('job-detail-body').innerHTML = description;
            document.getElementById('job-ai-result').classList.remove('active');
            updateSaveButton();

            document.getElementById('job-modal-overlay').classList.add('active');
            document.getElementById('job-modal').classList.add('active');
            document.body.style.overflow = 'hidden';

            if (typeof lucide !== 'undefined') {
                lucide.createIcons();
            }
        }

        function closeJob() {
            document.getElementById('job-modal-overlay').classList.remove('active');
            document.getElementById('job-modal').classList.remove('active');
            document.body.style.overflow = '';
            currentJob = null;
        }

        async function applyForJob() {
            if (!currentJob) return;
            
            if (currentJob.applicationLink) {
                window.open(currentJob.applicationLink, '_blank');
                showAlert('Application Link Opened', `Opening ${currentJob.title} application page in new tab.`);
            } else {
                showAlert('Application Note', `Your interest in the ${currentJob.title} position at ${currentJob.company} has been noted. Check the job details for application instructions.`);
            }
        }

        async function toggleSaveJob() {
            if (!currentJob) return;
            
            if (!currentUser) {
                showAlert('Sign In Required', 'Please sign in to save jobs.');
                return;
            }
            
            try {
                const response = await ApiService.post(`/auth/save-job/${currentJob.id}`);
                
                if (response.success) {
                    const btn = document.getElementById('job-save-btn');
                    if (response.data.savedJobs.includes(currentJob.id)) {
                        btn.classList.add('saved');
                        btn.innerHTML = '<i class="fas fa-bookmark"></i>';
                        showAlert('Job Saved!', `${currentJob.title} at ${currentJob.company} has been saved.`);
                    } else {
                        btn.classList.remove('saved');
                        btn.innerHTML = '<i class="far fa-bookmark"></i>';
                        showAlert('Job Removed', `${currentJob.title} has been removed from your saved jobs.`);
                    }
                }
            } catch (error) {
                console.error('Error saving job:', error);
                showAlert('Error', 'Failed to save job. Please try again.');
            }
        }

        async function updateSaveButton() {
            if (!currentJob || !currentUser) return;
            
            try {
                const response = await ApiService.get('/auth/saved-items');
                if (response.success) {
                    const btn = document.getElementById('job-save-btn');
                    if (response.data.savedJobs.some(j => j.id === currentJob.id)) {
                        btn.classList.add('saved');
                        btn.innerHTML = '<i class="fas fa-bookmark"></i>';
                    } else {
                        btn.classList.remove('saved');
                        btn.innerHTML = '<i class="far fa-bookmark"></i>';
                    }
                }
            } catch (error) {
                console.error('Error checking saved status:', error);
            }
        }

        // =============================================
        // RADIO FUNCTIONS
        // =============================================
        const radioPlayer = document.getElementById('radio-player');

        function toggleRadio(id, name, streamUrl) {
            const nowPlaying = document.getElementById('now-playing');
            const nowPlayingName = document.getElementById('now-playing-name');

            if (currentRadio === id) {
                stopRadio();
            } else {
                radioPlayer.src = streamUrl;
                radioPlayer.play().catch(e => {
                    showAlert('Stream Unavailable', 'This radio stream is currently unavailable. Please try another station.');
                });
                currentRadio = id;
                nowPlayingName.textContent = name;
                nowPlaying.classList.add('active');
                renderRadio();
                renderHomeRadio();
            }
        }

        function stopRadio() {
            radioPlayer.pause();
            radioPlayer.src = '';
            currentRadio = null;
            document.getElementById('now-playing').classList.remove('active');
            renderRadio();
            renderHomeRadio();
        }

        // =============================================
        // AUTH FUNCTIONS
        // =============================================
        function toggleAuth() {
            if (currentUser) {
                signOut();
            } else {
                openAuthModal();
            }
        }

        function openAuthModal() {
            document.getElementById('auth-modal-overlay').classList.add('active');
            document.getElementById('auth-modal').classList.add('active');
            document.body.style.overflow = 'hidden';
            showSignIn();
        }

        function closeAuthModal() {
            document.getElementById('auth-modal-overlay').classList.remove('active');
            document.getElementById('auth-modal').classList.remove('active');
            document.body.style.overflow = '';
        }

        function showSignIn() {
            document.getElementById('signin-form').style.display = 'block';
            document.getElementById('signup-form').style.display = 'none';
            document.getElementById('auth-modal-title').textContent = 'Sign In';
        }

        function showSignUp() {
            document.getElementById('signin-form').style.display = 'none';
            document.getElementById('signup-form').style.display = 'block';
            document.getElementById('auth-modal-title').textContent = 'Sign Up';
        }

        async function signIn() {
            const email = document.getElementById('signin-email').value;
            const password = document.getElementById('signin-password').value;
            
            if (!email || !password) {
                showAlert('Missing Information', 'Please enter both email and password.');
                return;
            }
            
            try {
                const response = await ApiService.post('/auth/signin', { email, password });
                
                if (response.success) {
                    localStorage.setItem('token', response.data.token);
                    localStorage.setItem('user', JSON.stringify(response.data.user));
                    currentUser = response.data.user;
                    
                    updateProfileUI();
                    closeAuthModal();
                    showAlert('Welcome!', `Successfully signed in as ${currentUser.username}.`);
                }
            } catch (error) {
                showAlert('Sign In Failed', error.message || 'Invalid credentials. Please try again.');
            }
        }

        async function signUp() {
            const name = document.getElementById('signup-name').value;
            const email = document.getElementById('signup-email').value;
            const phone = document.getElementById('signup-phone').value;
            const password = document.getElementById('signup-password').value;
            const confirm = document.getElementById('signup-confirm').value;
            
            if (!name || !email || !phone || !password || !confirm) {
                showAlert('Missing Information', 'Please fill in all fields.');
                return;
            }
            
            if (password !== confirm) {
                showAlert('Password Mismatch', 'Passwords do not match.');
                return;
            }
            
            try {
                const response = await ApiService.post('/auth/signup', {
                    username: name,
                    email,
                    phone,
                    password
                });
                
                if (response.success) {
                    document.getElementById('otp-email').textContent = email;
                    document.getElementById('auth-modal-overlay').classList.remove('active');
                    document.getElementById('auth-modal').classList.remove('active');
                    document.getElementById('otp-modal-overlay').classList.add('active');
                    document.getElementById('otp-modal').classList.add('active');
                }
            } catch (error) {
                showAlert('Sign Up Failed', error.message || 'Failed to create account. Please try again.');
            }
        }

        async function verifyOTP() {
            const otp1 = document.getElementById('otp-1').value;
            const otp2 = document.getElementById('otp-2').value;
            const otp3 = document.getElementById('otp-3').value;
            const otp4 = document.getElementById('otp-4').value;
            const otp = otp1 + otp2 + otp3 + otp4;
            
            const email = document.getElementById('otp-email').textContent;
            
            try {
                const response = await ApiService.post('/auth/verify-otp', { email, otp });
                
                if (response.success) {
                    localStorage.setItem('token', response.data.token);
                    localStorage.setItem('user', JSON.stringify(response.data.user));
                    currentUser = response.data.user;
                    
                    closeOTPModal();
                    updateProfileUI();
                    showAlert('Welcome!', 'Account created and verified successfully!');
                }
            } catch (error) {
                showAlert('Verification Failed', error.message || 'Invalid OTP. Please try again.');
            }
        }

        function closeOTPModal() {
            document.getElementById('otp-modal-overlay').classList.remove('active');
            document.getElementById('otp-modal').classList.remove('active');
            document.body.style.overflow = '';
            clearOTPFields();
        }

        function resendOTP() {
            showAlert('OTP Resent', 'Verification code has been resent to your email. Use 0000 for demo.');
        }

        function clearOTPFields() {
            for (let i = 1; i <= 4; i++) {
                document.getElementById(`otp-${i}`).value = '';
            }
        }

        function moveToNext(current) {
            const input = document.getElementById(`otp-${current}`);
            if (input.value.length === 1 && current < 4) {
                document.getElementById(`otp-${current + 1}`).focus();
            }
        }

        function signOut() {
            localStorage.removeItem('token');
            localStorage.removeItem('user');
            currentUser = null;
            updateProfileUI();
            showAlert('Signed Out', 'You have been signed out.');
        }

        function updateProfileUI() {
            const authBtn = document.getElementById('auth-btn');
            const profileName = document.getElementById('profile-name');
            const profileEmail = document.getElementById('profile-email');
            
            if (currentUser) {
                profileName.textContent = currentUser.username || currentUser.name;
                profileEmail.textContent = currentUser.email;
                authBtn.innerHTML = '<i class="fas fa-sign-out-alt"></i> Sign Out';
            } else {
                profileName.textContent = 'Guest User';
                profileEmail.textContent = 'Not signed in';
                authBtn.innerHTML = '<i class="fas fa-sign-in-alt"></i> Sign In / Sign Up';
            }
        }

        async function openEditProfile() {
            if (!currentUser) {
                showAlert('Sign In Required', 'Please sign in to edit your profile.');
                return;
            }
            
            try {
                const response = await ApiService.get('/auth/profile');
                if (response.success) {
                    const user = response.data.user;
                    document.getElementById('edit-name').value = user.username || '';
                    document.getElementById('edit-email').value = user.email || '';
                    document.getElementById('edit-phone').value = user.phone || '';
                    document.getElementById('edit-location').value = user.location || '';
                    document.getElementById('edit-bio').value = user.bio || '';
                    
                    document.getElementById('edit-profile-overlay').classList.add('active');
                    document.getElementById('edit-profile-modal').classList.add('active');
                    document.body.style.overflow = 'hidden';
                }
            } catch (error) {
                showAlert('Error', 'Failed to load profile. Please try again.');
            }
        }

        function closeEditProfile() {
            document.getElementById('edit-profile-overlay').classList.remove('active');
            document.getElementById('edit-profile-modal').classList.remove('active');
            document.body.style.overflow = '';
        }

        async function saveProfile() {
            const name = document.getElementById('edit-name').value;
            const phone = document.getElementById('edit-phone').value;
            const location = document.getElementById('edit-location').value;
            const bio = document.getElementById('edit-bio').value;
            
            if (!name) {
                showAlert('Missing Name', 'Please enter your name.');
                return;
            }
            
            try {
                const response = await ApiService.put('/auth/profile', {
                    username: name,
                    phone,
                    location,
                    bio
                });
                
                if (response.success) {
                    currentUser = response.data.user;
                    localStorage.setItem('user', JSON.stringify(currentUser));
                    
                    updateProfileUI();
                    closeEditProfile();
                    showAlert('Profile Updated', 'Your profile has been updated successfully.');
                }
            } catch (error) {
                showAlert('Update Failed', error.message || 'Failed to update profile. Please try again.');
            }
        }

        async function viewSavedItems() {
            if (!currentUser) {
                showAlert('Sign In Required', 'Please sign in to view saved items.');
                return;
            }
            
            try {
                const response = await ApiService.get('/auth/saved-items');
                if (response.success) {
                    const savedJobs = response.data.savedJobs || [];
                    const savedArticles = response.data.savedArticles || [];
                    
                    let message = 'Your Saved Items:\n\n';
                    
                    if (savedJobs.length > 0) {
                        message += `Jobs (${savedJobs.length}):\n`;
                        savedJobs.forEach(job => {
                            message += ` ${job.title} at ${job.company}\n`;
                        });
                        message += '\n';
                    }
                    
                    if (savedArticles.length > 0) {
                        message += `Articles (${savedArticles.length}):\n`;
                        savedArticles.forEach(article => {
                            message += ` ${article.title}\n`;
                        });
                    }
                    
                    if (savedJobs.length === 0 && savedArticles.length === 0) {
                        message = 'You have no saved items yet.';
                    }
                    
                    showAlert('Saved Items', message);
                }
            } catch (error) {
                showAlert('Error', 'Failed to load saved items. Please try again.');
            }
        }

        // =============================================
        // EXCHANGE RATES FUNCTIONS
        // =============================================
        function openRatesPage() {
            Object.keys(exchangeRatesData).forEach(pair => {
                const data = exchangeRatesData[pair];
                const elementId = 'detail-' + pair.toLowerCase().replace('/', '-');
                const changeId = 'change-' + pair.toLowerCase().replace('/', '-');

                const rateEl = document.getElementById(elementId);
                const changeEl = document.getElementById(changeId);

                if (rateEl) {
                    rateEl.textContent = data.rate.toFixed(2);
                }

                if (changeEl) {
                    const changeClass = data.change > 0 ? 'up' : data.change < 0 ? 'down' : 'neutral';
                    const icon = data.change > 0 ? 'fa-arrow-up' : data.change < 0 ? 'fa-arrow-down' : 'fa-minus';
                    const sign = data.change > 0 ? '+' : '';
                    changeEl.className = `rate-change ${changeClass}`;
                    changeEl.innerHTML = `<i class="fas ${icon}"></i> ${sign}${data.change.toFixed(2)}%`;
                }
            });

            document.getElementById('rates-modal-overlay').classList.add('active');
            document.getElementById('rates-modal').classList.add('active');
            document.body.style.overflow = 'hidden';

            setTimeout(() => {
                initRatesChart();
            }, 100);
        }

        function closeRatesPage() {
            document.getElementById('rates-modal-overlay').classList.remove('active');
            document.getElementById('rates-modal').classList.remove('active');
            document.body.style.overflow = '';
        }

        function initRatesChart() {
            const ctx = document.getElementById('ratesChart');
            if (!ctx) return;

            if (ratesChart) {
                ratesChart.destroy();
            }

            const isDark = document.documentElement.classList.contains('dark');
            const gridColor = isDark ? 'rgba(255,255,255,0.1)' : 'rgba(0,0,0,0.1)';
            const textColor = isDark ? '#A0A0A0' : '#666666';

            const data = historicalRates[currentChartPeriod];

            ratesChart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: data.labels,
                    datasets: [
                        {
                            label: 'ZWG',
                            data: data.zwg,
                            borderColor: '#319F43',
                            backgroundColor: 'rgba(49, 159, 67, 0.1)',
                            borderWidth: 2,
                            tension: 0.4,
                            fill: true,
                            pointRadius: 3,
                            pointBackgroundColor: '#319F43'
                        },
                        {
                            label: 'ZAR',
                            data: data.zar,
                            borderColor: '#FFD200',
                            backgroundColor: 'rgba(255, 210, 0, 0.1)',
                            borderWidth: 2,
                            tension: 0.4,
                            fill: true,
                            pointRadius: 3,
                            pointBackgroundColor: '#FFD200'
                        },
                        {
                            label: 'BWP',
                            data: data.bwp,
                            borderColor: '#DE2010',
                            backgroundColor: 'rgba(222, 32, 16, 0.1)',
                            borderWidth: 2,
                            tension: 0.4,
                            fill: true,
                            pointRadius: 3,
                            pointBackgroundColor: '#DE2010'
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    interaction: {
                        intersect: false,
                        mode: 'index'
                    },
                    plugins: {
                        legend: {
                            display: false
                        },
                        tooltip: {
                            backgroundColor: isDark ? '#1A1A1A' : '#FFFFFF',
                            titleColor: isDark ? '#F5F5F5' : '#1A1A1A',
                            bodyColor: isDark ? '#A0A0A0' : '#666666',
                            borderColor: isDark ? '#2A2A2A' : '#E5E5E5',
                            borderWidth: 1,
                            cornerRadius: 8,
                            padding: 12
                        }
                    },
                    scales: {
                        x: {
                            grid: {
                                color: gridColor,
                                drawBorder: false
                            },
                            ticks: {
                                color: textColor,
                                font: { size: 11 }
                            }
                        },
                        y: {
                            grid: {
                                color: gridColor,
                                drawBorder: false
                            },
                            ticks: {
                                color: textColor,
                                font: { size: 11 }
                            }
                        }
                    }
                }
            });
        }

        function updateChartPeriod(period) {
            currentChartPeriod = period;

            document.querySelectorAll('.chart-period-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');

            initRatesChart();
        }

        function closeRatesAiOutput() {
            document.getElementById('rates-ai-output').classList.remove('active');
            document.querySelectorAll('#rates-modal .ai-option').forEach(btn => btn.classList.remove('active'));
        }

        async function analyzeRates(type) {
            const outputDiv = document.getElementById('rates-ai-output');
            const resultDiv = document.getElementById('rates-ai-content');

            const ratesSummary = Object.entries(exchangeRatesData)
                .map(([pair, data]) => `${pair}: ${data.rate} (${data.change > 0 ? '+' : ''}${data.change}%)`)
                .join(', ');

            const hist7d = historicalRates['7d'];
            const hist30d = historicalRates['30d'];
            const historyData = `
7-Day Data:
- ZWG/USD: ${hist7d.zwg.join('  ')}
- ZAR/USD: ${hist7d.zar.join('  ')}
- BWP/USD: ${hist7d.bwp.join('  ')}

30-Day Data:
- ZWG/USD: ${hist30d.zwg.join('  ')}
- ZAR/USD: ${hist30d.zar.join('  ')}
- BWP/USD: ${hist30d.bwp.join('  ')}`;

            const prompts = {
                'overview': `Analyze these exchange rates and their trends:

Current Rates: ${ratesSummary}

Historical Trends:
${historyData}

Provide a brief factual summary of market movements. Keep it to 2-3 short paragraphs.`,
                'zwg': `Analyze the ZWG currency based on this data:

Current: USD/ZWG = ${exchangeRatesData['USD/ZWG'].rate} (${exchangeRatesData['USD/ZWG'].change > 0 ? '+' : ''}${exchangeRatesData['USD/ZWG'].change}% today)

7-Day ZWG trend: ${hist7d.zwg.join('  ')}
30-Day ZWG trend: ${hist30d.zwg.join('  ')}

Analyze the stability and trend. Keep it factual, 2-3 short paragraphs.`
            };

            outputDiv.classList.add('active');
            resultDiv.innerHTML = '<div class="ai-loading"><div class="spinner"></div><span>Analyzing market data...</span></div>';

            document.querySelectorAll('#rates-modal .ai-option').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');

            if (typeof lucide !== 'undefined') {
                lucide.createIcons();
            }

            try {
                const response = await fetch('https://grey-api.vercel.app/api/chat', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        model: 'gpt-4o',
                        messages: [
                            { role: 'system', content: 'You are a data analyst. Analyze the provided data objectively. Be concise and factual. Do not give advice or make assumptions beyond what the data shows.' },
                            { role: 'user', content: prompts[type] }
                        ]
                    })
                });

                const data = await response.json();
                if (data.response) {
                    resultDiv.innerHTML = data.response.replace(/\n/g, '<br>');
                    if (typeof lucide !== 'undefined') {
                        lucide.createIcons();
                    }
                } else {
                    throw new Error('Invalid response');
                }
            } catch (error) {
                console.error('AI Analysis error:', error);
                resultDiv.innerHTML = '<p style="color: var(--zim-red);">Unable to generate analysis. Please try again.</p>';
            }
        }

        // =============================================
        // AI FUNCTIONS
        // =============================================
        async function rewriteArticle(style) {
            if (!currentArticle) return;

            document.querySelectorAll('.ai-option').forEach(btn => btn.classList.remove('active'));
            event.target.closest('.ai-option').classList.add('active');

            const aiOutput = document.getElementById('ai-output');
            const aiContent = document.getElementById('ai-output-content');
            const aiMode = document.getElementById('ai-output-mode');

            aiOutput.classList.add('active');
            aiContent.innerHTML = `
                <div class="ai-loading">
                    <div class="spinner"></div>
                    <span>Processing with AI...</span>
                </div>
            `;

            const styleLabels = {
                'concise': 'Concise Summary',
                'simple': 'Simple Language',
                'shona': 'Shona Translation',
                'ndebele': 'Ndebele Translation'
            };
            aiMode.textContent = styleLabels[style];

            let systemPrompt = '';
            switch (style) {
                case 'concise':
                    systemPrompt = 'You are a news editor. Rewrite the following article in a concise, bullet-point format highlighting only the key facts. Keep it brief and scannable.';
                    break;
                case 'simple':
                    systemPrompt = 'You are a helpful assistant. Rewrite the following article in very simple, easy-to-understand language. Avoid complex words and explain any necessary terms.';
                    break;
                case 'ndebele':
                    systemPrompt = 'You are a professional translator. Translate the following English text to Ndebele (isiNdebele/Sindebele). Maintain the meaning and tone.';
                    break;
                case 'shona':
                    systemPrompt = 'You are a professional translator. Translate the following English text to Shona (chiShona). Maintain the meaning and tone.';
                    break;
                default:
                    systemPrompt = 'Rewrite the following text clearly.';
            }

            try {
                const response = await fetch('https://grey-api.vercel.app/api/chat', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        model: 'gpt-4o',
                        messages: [
                            { role: 'system', content: systemPrompt },
                            { role: 'user', content: `Title: ${currentArticle.title}\n\nArticle:\n${currentArticle.content || currentArticle.description}` }
                        ]
                    })
                });

                const data = await response.json();

                if (data.response) {
                    aiContent.innerHTML = data.response.replace(/\n/g, '<br>');
                    if (typeof lucide !== 'undefined') {
                        lucide.createIcons();
                    }
                } else {
                    throw new Error('Invalid response format');
                }
            } catch (error) {
                console.error('AI Error:', error);
                aiContent.innerHTML = `<p style="color: var(--zim-red);">Sorry, unable to process this article right now. Please try again later.</p>`;
            }
        }

        function closeAiOutput() {
            document.getElementById('ai-output').classList.remove('active');
            document.querySelectorAll('.ai-option').forEach(btn => btn.classList.remove('active'));
        }

        // =============================================
        // JOB SHARE FUNCTIONS
        // =============================================
        function openJobShareModal() {
            document.getElementById('job-share-overlay').classList.add('active');
            document.getElementById('job-share-modal').classList.add('active');
        }

        function closeJobShareModal() {
            document.getElementById('job-share-overlay').classList.remove('active');
            document.getElementById('job-share-modal').classList.remove('active');
        }

        function shareJob(platform) {
            if (!currentJob) return;

            const text = encodeURIComponent(` Job Opportunity: ${currentJob.title} at ${currentJob.company}\n\n ${currentJob.location}\n ${currentJob.salary}\n\nCheck it out on iNasi!`);
            const url = encodeURIComponent(window.location.href);

            let shareUrl = '';

            switch (platform) {
                case 'whatsapp':
                    shareUrl = `https://wa.me/?text=${text}`;
                    break;
                case 'facebook':
                    shareUrl = `https://www.facebook.com/sharer/sharer.php?quote=${text}`;
                    break;
                case 'twitter':
                    shareUrl = `https://twitter.com/intent/tweet?text=${text}`;
                    break;
                case 'linkedin':
                    shareUrl = `https://www.linkedin.com/sharing/share-offsite/?url=${url}`;
                    break;
            }

            if (shareUrl) {
                window.open(shareUrl, '_blank', 'width=600,height=400');
            }
            closeJobShareModal();
        }

        // =============================================
        // JOB AI TOOLS
        // =============================================
        async function generateJobCV() {
            if (!currentJob) return;
            await runJobAITool('cv', 'Tailored CV', `You are a professional CV/resume writer. Create a tailored CV template optimized for the following job position. Include sections that highlight relevant skills and experience for this specific role. Format it professionally.

Job Title: ${currentJob.title}
Company: ${currentJob.company}
Required Skills: ${(currentJob.tags || []).join(', ')}
Job Description:
${currentJob.description}

Create a CV template with placeholder sections that a candidate can fill in, with specific guidance on what to emphasize for this role.`);
        }

        async function generateCoverLetter() {
            if (!currentJob) return;
            await runJobAITool('cover', 'Cover Letter', `You are a professional cover letter writer. Write a compelling cover letter template for the following job position. The letter should be professional, enthusiastic, and highlight how a candidate's skills align with the role.

Job Title: ${currentJob.title}
Company: ${currentJob.company}
Location: ${currentJob.location}
Required Skills: ${(currentJob.tags || []).join(', ')}
Job Description:
${currentJob.description}

Create a cover letter with placeholder sections [YOUR NAME], [YOUR EXPERIENCE], etc. that candidates can personalize.`);
        }

        async function prepareJobInterview() {
            if (!currentJob) return;
            await runJobAITool('interview', 'Interview Prep', `You are an expert career coach. Prepare interview questions and suggested answers specifically for the following job position. Include both technical and behavioral questions.

Job Title: ${currentJob.title}
Company: ${currentJob.company}
Industry: Based on the company
Required Skills: ${(currentJob.tags || []).join(', ')}
Job Description:
${currentJob.description}

Provide:
1. 5 likely technical/role-specific questions with sample answers
2. 3 behavioral questions using STAR method
3. 2 questions the candidate should ask the interviewer`);
        }

        async function negotiateSalary() {
            if (!currentJob) return;
            await runJobAITool('salary', 'Salary Negotiation Tips', `You are a salary negotiation expert familiar with the Zimbabwean job market. Provide salary negotiation tips and strategies for the following position.

Job Title: ${currentJob.title}
Company: ${currentJob.company}
Stated Salary: ${currentJob.salary || 'Not specified'}
Location: ${currentJob.location}

Provide:
1. Market context for this role in Zimbabwe
2. Key negotiation strategies
3. What to say and what to avoid
4. Benefits and perks to negotiate beyond base salary
5. Timing advice for bringing up salary discussions`);
        }

        async function runJobAITool(type, title, prompt) {
            const resultBox = document.getElementById('job-ai-result');
            const resultTitle = document.getElementById('job-ai-result-title');
            const resultContent = document.getElementById('job-ai-result-content');

            resultTitle.textContent = title;
            resultBox.classList.add('active');
            resultContent.innerHTML = `
                <div class="ai-loading">
                    <div class="spinner"></div>
                    <span>Generating ${title.toLowerCase()}...</span>
                </div>
            `;

            resultBox.scrollIntoView({ behavior: 'smooth', block: 'center' });

            try {
                const response = await fetch('https://grey-api.vercel.app/api/chat', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        model: 'gpt-4o',
                        messages: [
                            { role: 'system', content: 'You are a helpful career assistant specializing in the Zimbabwean job market. Provide practical, actionable advice.' },
                            { role: 'user', content: prompt }
                        ]
                    })
                });

                const data = await response.json();

                if (data.response) {
                    resultContent.innerHTML = formatMarkdown(data.response);
                    if (typeof lucide !== 'undefined') {
                        lucide.createIcons();
                    }
                } else {
                    throw new Error('Invalid response');
                }
            } catch (error) {
                console.error('AI Tool Error:', error);
                resultContent.innerHTML = `<p style="color: var(--zim-red);">Sorry, unable to generate content right now. Please try again later.</p>`;
            }
        }

        // =============================================
        // FAB FUNCTIONS
        // =============================================
        function toggleFab() {
            fabOpen = !fabOpen;
            const fabMain = document.getElementById('fab-main');
            const fabOptions = document.getElementById('fab-options');

            if (fabOpen) {
                fabMain.classList.add('active');
                fabOptions.classList.add('active');
            } else {
                fabMain.classList.remove('active');
                fabOptions.classList.remove('active');
            }
        }

        function closeFab() {
            fabOpen = false;
            const fabMain = document.getElementById('fab-main');
            const fabOptions = document.getElementById('fab-options');
            if (fabMain) fabMain.classList.remove('active');
            if (fabOptions) fabOptions.classList.remove('active');
        }

        // =============================================
        // CV BUILDER FUNCTIONS
        // =============================================
        function openCVBuilder() {
            closeFab();
            document.getElementById('cv-modal-overlay').classList.add('active');
            document.getElementById('cv-modal').classList.add('active');
            document.body.style.overflow = 'hidden';
            document.getElementById('cv-result').classList.remove('active');
            if (typeof lucide !== 'undefined') {
                lucide.createIcons();
            }
        }

        function closeCVBuilder() {
            document.getElementById('cv-modal-overlay').classList.remove('active');
            document.getElementById('cv-modal').classList.remove('active');
            document.body.style.overflow = '';
        }

        async function generateCV() {
            const name = document.getElementById('cv-name').value.trim();
            const job = document.getElementById('cv-job').value.trim();
            const experience = document.getElementById('cv-experience').value.trim();
            const skills = document.getElementById('cv-skills').value.trim();
            const education = document.getElementById('cv-education').value.trim();
            const work = document.getElementById('cv-work').value.trim();

            if (!name || !job) {
                showAlert('Missing Information', 'Please enter at least your name and target job title.');
                return;
            }

            const btn = document.getElementById('cv-generate-btn');
            const resultBox = document.getElementById('cv-result');
            const resultContent = document.getElementById('cv-result-content');

            btn.disabled = true;
            btn.innerHTML = '<div class="spinner" style="width:20px;height:20px;border:2px solid rgba(255,255,255,0.3);border-top-color:white;border-radius:50%;animation:spin 1s linear infinite;"></div> Generating...';

            const systemPrompt = `You are a professional CV/resume writer specializing in creating compelling CVs for the Zimbabwean job market. Create a well-structured, professional CV based on the information provided. Format it cleanly with clear sections. Use bullet points for responsibilities and achievements. Make it ATS-friendly.`;

            const userPrompt = `Create a professional CV for:
Name: ${name}
Target Position: ${job}
Experience: ${experience || 'Not specified'}
Skills: ${skills || 'Not specified'}
Education: ${education || 'Not specified'}
Work History: ${work || 'Not specified'}

Please create a complete, professional CV that highlights strengths and is tailored for the ${job} role.`;

            try {
                const response = await fetch('https://grey-api.vercel.app/api/chat', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        model: 'gpt-4o',
                        messages: [
                            { role: 'system', content: systemPrompt },
                            { role: 'user', content: userPrompt }
                        ]
                    })
                });

                const data = await response.json();

                if (data.response) {
                    resultContent.innerHTML = formatMarkdown(data.response);
                    resultBox.classList.add('active');
                    if (typeof lucide !== 'undefined') {
                        lucide.createIcons();
                    }
                } else {
                    throw new Error('Invalid response');
                }
            } catch (error) {
                console.error('CV Generation Error:', error);
                showAlert('Error', 'Failed to generate CV. Please try again.');
            } finally {
                btn.disabled = false;
                btn.innerHTML = '<i data-lucide="sparkles"></i> Generate CV';
                if (typeof lucide !== 'undefined') {
                    lucide.createIcons();
                }
            }
        }

        // =============================================
        // COVER LETTER FUNCTIONS
        // =============================================
        function openCoverLetterBuilder() {
            closeFab();
            document.getElementById('cover-modal-overlay').classList.add('active');
            document.getElementById('cover-modal').classList.add('active');
            document.body.style.overflow = 'hidden';
            document.getElementById('cover-result').classList.remove('active');
            if (typeof lucide !== 'undefined') {
                lucide.createIcons();
            }
        }

        function closeCoverLetterBuilder() {
            document.getElementById('cover-modal-overlay').classList.remove('active');
            document.getElementById('cover-modal').classList.remove('active');
            document.body.style.overflow = '';
        }

        async function generateCoverLetterFAB() {
            const name = document.getElementById('cover-name').value.trim();
            const job = document.getElementById('cover-job').value.trim();
            const company = document.getElementById('cover-company').value.trim();
            const skills = document.getElementById('cover-skills').value.trim();
            const experience = document.getElementById('cover-experience').value.trim();
            const why = document.getElementById('cover-why').value.trim();

            if (!name || !job || !company) {
                showAlert('Missing Information', 'Please enter your name, job title, and company name.');
                return;
            }

            const btn = document.getElementById('cover-generate-btn');
            const resultBox = document.getElementById('cover-result');
            const resultContent = document.getElementById('cover-result-content');

            btn.disabled = true;
            btn.innerHTML = '<div class="spinner" style="width:20px;height:20px;border:2px solid rgba(255,255,255,0.3);border-top-color:white;border-radius:50%;animation:spin 1s linear infinite;"></div> Generating...';

            const systemPrompt = `You are a professional cover letter writer. Write compelling, personalized cover letters that help candidates stand out. The tone should be professional yet personable, highlighting the candidate's value proposition.`;

            const userPrompt = `Write a professional cover letter for:
Name: ${name}
Position: ${job}
Company: ${company}
Key Skills: ${skills || 'Not specified'}
Experience: ${experience || 'Not specified'}
Motivation: ${why || 'Not specified'}

Create a compelling cover letter that:
1. Opens with a strong, attention-grabbing introduction
2. Highlights relevant skills and experience
3. Shows genuine interest in the company
4. Ends with a confident call to action
Keep it concise (about 300-400 words).`;

            try {
                const response = await fetch('https://grey-api.vercel.app/api/chat', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        model: 'gpt-4o',
                        messages: [
                            { role: 'system', content: systemPrompt },
                            { role: 'user', content: userPrompt }
                        ]
                    })
                });

                const data = await response.json();

                if (data.response) {
                    resultContent.innerHTML = formatMarkdown(data.response);
                    resultBox.classList.add('active');
                    if (typeof lucide !== 'undefined') {
                        lucide.createIcons();
                    }
                } else {
                    throw new Error('Invalid response');
                }
            } catch (error) {
                console.error('Cover Letter Generation Error:', error);
                showAlert('Error', 'Failed to generate cover letter. Please try again.');
            } finally {
                btn.disabled = false;
                btn.innerHTML = '<i data-lucide="sparkles"></i> Generate Cover Letter';
                if (typeof lucide !== 'undefined') {
                    lucide.createIcons();
                }
            }
        }

        // =============================================
        // INTERVIEW PREP FUNCTIONS
        // =============================================
        function openInterviewPrep() {
            closeFab();
            document.getElementById('interview-modal-overlay').classList.add('active');
            document.getElementById('interview-modal').classList.add('active');
            document.body.style.overflow = 'hidden';
            document.getElementById('interview-result').classList.remove('active');
            if (typeof lucide !== 'undefined') {
                lucide.createIcons();
            }
        }

        function closeInterviewPrep() {
            document.getElementById('interview-modal-overlay').classList.remove('active');
            document.getElementById('interview-modal').classList.remove('active');
            document.body.style.overflow = '';
        }

        async function generateInterviewPrep() {
            const job = document.getElementById('interview-job').value.trim();
            const company = document.getElementById('interview-company').value.trim();
            const industry = document.getElementById('interview-industry').value.trim();
            const level = document.getElementById('interview-level').value;
            const type = document.getElementById('interview-type').value;

            if (!job) {
                showAlert('Missing Information', 'Please enter the job title you are applying for.');
                return;
            }

            const btn = document.getElementById('interview-generate-btn');
            const resultBox = document.getElementById('interview-result');
            const resultContent = document.getElementById('interview-result-content');

            btn.disabled = true;
            btn.innerHTML = '<div class="spinner" style="width:20px;height:20px;border:2px solid rgba(255,255,255,0.3);border-top-color:white;border-radius:50%;animation:spin 1s linear infinite;"></div> Generating...';

            const levelLabels = {
                'entry': 'entry-level (0-2 years experience)',
                'mid': 'mid-level (3-5 years experience)',
                'senior': 'senior-level (5+ years experience)',
                'manager': 'management level'
            };

            const typePrompts = {
                'questions': 'Generate 10 common interview questions with suggested answers',
                'behavioral': 'Generate 8 behavioral interview questions using the STAR method (Situation, Task, Action, Result) with example answers',
                'technical': 'Generate 10 technical/role-specific interview questions with detailed answers',
                'tips': 'Provide comprehensive interview tips including preparation, body language, common mistakes to avoid, and how to make a great impression'
            };

            const systemPrompt = `You are an expert career coach and interview preparation specialist with deep knowledge of the Zimbabwean and African job market. Provide practical, actionable interview preparation advice.`;

            const userPrompt = `Prepare interview material for:
Position: ${job}
Company: ${company || 'Not specified'}
Industry: ${industry || 'General'}
Experience Level: ${levelLabels[level]}

Task: ${typePrompts[type]}

Please provide detailed, practical advice that will help the candidate succeed in their interview.`;

            try {
                const response = await fetch('https://grey-api.vercel.app/api/chat', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        model: 'gpt-4o',
                        messages: [
                            { role: 'system', content: systemPrompt },
                            { role: 'user', content: userPrompt }
                        ]
                    })
                });

                const data = await response.json();

                if (data.response) {
                    resultContent.innerHTML = formatMarkdown(data.response);
                    resultBox.classList.add('active');
                    if (typeof lucide !== 'undefined') {
                        lucide.createIcons();
                    }
                } else {
                    throw new Error('Invalid response');
                }
            } catch (error) {
                console.error('Interview Prep Error:', error);
                showAlert('Error', 'Failed to generate interview prep. Please try again.');
            } finally {
                btn.disabled = false;
                btn.innerHTML = '<i data-lucide="sparkles"></i> Generate Prep Material';
                if (typeof lucide !== 'undefined') {
                    lucide.createIcons();
                }
            }
        }

        // =============================================
        // COPY FUNCTION
        // =============================================
        async function copyResult(elementId) {
            const element = document.getElementById(elementId);

            const clone = element.cloneNode(true);
            let text = clone.innerHTML
                .replace(/<\/h[234]>/gi, '\n\n')
                .replace(/<h[234][^>]*>/gi, '')
                .replace(/<\/p>/gi, '\n\n')
                .replace(/<p[^>]*>/gi, '')
                .replace(/<li>/gi, ' ')
                .replace(/<\/li>/gi, '\n')
                .replace(/<\/?ul[^>]*>/gi, '\n')
                .replace(/<\/?ol[^>]*>/gi, '\n')
                .replace(/<br\s*\/?>/gi, '\n')
                .replace(/<\/?strong>/gi, '')
                .replace(/<\/?em>/gi, '')
                .replace(/<\/?b>/gi, '')
                .replace(/<\/?i>/gi, '')
                .replace(/<[^>]+>/g, '')
                .replace(/&amp;/g, '&')
                .replace(/&lt;/g, '<')
                .replace(/&gt;/g, '>')
                .replace(/&nbsp;/g, ' ')
                .replace(/\n{3,}/g, '\n\n')
                .trim();

            try {
                await navigator.clipboard.writeText(text);
                showAlert('Copied!', 'Content copied to clipboard.');
            } catch (err) {
                showAlert('Copy Failed', 'Unable to copy to clipboard. Please select and copy manually.');
            }
        }

        // =============================================
        // SUPPORT FUNCTIONS
        // =============================================
        function contactUs() {
            showAlert('Contact Us', 'Email: support@inasi.co.zw\nPhone: +263 242 123456\nHours: Mon-Fri 8AM-5PM');
        }

        function openPrivacyPolicy() {
            showAlert('Privacy Policy', `We take your privacy seriously. Your data is protected and never shared without consent.

1. Data Collection: We collect minimal data for service improvement.
2. Data Usage: Used only to enhance your experience.
3. Data Protection: Encrypted storage and secure transmission.
4. Your Rights: You can request data deletion anytime.

For questions: privacy@inasi.co.zw`);
        }

        function openTerms() {
            showAlert('Terms & Conditions', `Welcome to iNasi. By using our service, you agree to:

1. Service Usage: For personal, non-commercial use only.
2. Content: We provide news, jobs, and services as-is.
3. User Conduct: Respect other users and Zimbabwean laws.
4. Liability: We're not liable for third-party content.
5. Changes: We may update these terms periodically.

Last updated: ${new Date().toLocaleDateString()}`);
        }

        // =============================================
        // ALERT FUNCTIONS
        // =============================================
        function showAlert(title, message) {
            document.getElementById('alert-title').textContent = title;
            document.getElementById('alert-message').textContent = message;
            document.getElementById('custom-alert').classList.add('active');
        }

        function closeAlert() {
            document.getElementById('custom-alert').classList.remove('active');
        }
    </script>
</body>
    </html>
